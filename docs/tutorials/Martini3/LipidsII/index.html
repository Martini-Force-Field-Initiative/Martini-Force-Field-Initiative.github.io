<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lipid bilayers - Part II: Complex mixtures ‚Äì Martini Force Field Initiative</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../images/favicon.png" rel="icon" type="image/png">
<script src="../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-e869d40512ada2bc71900344281996dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../../../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const quotes = [
          "<i>Shaken, not stirred.</i> - James Bond",
          "<i>He was white and shaken, like a dry martini.</i> - P. G. Wodehouse",      
          "<i>I think people think we're all sipping martinis by the pool.</i> - Maria Menounos",
          "<i>Why don't you get out of that wet coat and into a dry martini?</i> - Robert Benchley",
          "<i>Really, can anyone drink several martinis at lunch?</i> - Christine Baranski",
          "<i>Zen martini: A martini with no vermouth at all. And no gin, either.</i> - P.J. O'Rourke",
          "<i>I never go jogging, it makes me spill my martini.</i> - George Burns",
          "<i>Martinis are the only American invention as perfect as a sonnet.</i> - H. L. Mencken",
          "<i>He knows just how I like my martini: full of alcohol.</i> - Homer Simpson",
          "<i>Happiness is: finding olives in your martini when you're hungry.</i> - Johnny Carson",
          "<i>If it wasn't for the olives in his martinis he'd starve to death.</i> - Milton Berle",
        ];
      const randomIndex = Math.floor(Math.random() * quotes.length);
      const randomQuote = quotes[randomIndex];

      const footerLeft = document.querySelector('.footer-left');
      if (footerLeft) {
          footerLeft.innerHTML = randomQuote;
      }
    });
</script>


<link rel="stylesheet" href="../../../../styles.css">
<meta property="og:title" content="Lipid bilayers - Part II: Complex mixtures ‚Äì Martini Force Field Initiative">
<meta property="og:description" content="">
<meta property="og:image" content="https://cgmartini.nl/docs/tutorials/Martini3/LipidsII/Fig1.png">
<meta property="og:site_name" content="Martini Force Field Initiative">
<meta property="og:image:height" content="750">
<meta property="og:image:width" content="1800">
<meta name="twitter:title" content="Lipid bilayers - Part II: Complex mixtures ‚Äì Martini Force Field Initiative">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://cgmartini.nl/docs/tutorials/Martini3/LipidsII/Fig1.png">
<meta name="twitter:image-height" content="750">
<meta name="twitter:image-width" content="1800">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../images/martini.gif" alt="martini logo" class="navbar-logo light-content">
    <img src="../../../../images/martini.gif" alt="martini logo" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../index.html"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../../docs/tutorials/index.html" aria-current="page"> <i class="bi bi-mortarboard-fill" role="img">
</i> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/downloads/index.html"> <i class="bi bi-download" role="img">
</i> 
<span class="menu-text">Downloads</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/publications/index.html"> <i class="bi bi-newspaper" role="img">
</i> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/announcements/index.html"> 
<span class="menu-text"><i class="fa-solid fa-bullhorn" aria-label="bullhorn"></i> Announcements</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/contact/index.html"> 
<span class="menu-text"><i class="fa-regular fa-address-book" aria-label="address-book"></i> Contact</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-fa-circle-info--help" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i> Help</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-fa-circle-info--help">    
        <li>
    <a class="dropdown-item" href="https://github.com/orgs/Martini-Force-Field-Initiative/discussions"><i class="bi bi-chat-right-text" role="img">
</i> 
 <span class="dropdown-text">Discussion Board</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/orgs/Martini-Force-Field-Initiative/discussions"><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">Report an Issue</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../docs/faq/index.html"><i class="bi bi-question-circle" role="img">
</i> 
 <span class="dropdown-text">FAQs</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/Martini-Force-Field-Initiative" title="Martini GitHub" class="quarto-navigation-tool px-1" aria-label="Martini GitHub"><i class="bi bi-github"></i></a>
    <a href="https://x.com/cg_martini" title="Martini Twitter" class="quarto-navigation-tool px-1" aria-label="Martini Twitter"><i class="bi bi-twitter-x"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Lipid bilayers - Part II: Complex mixtures</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b>Summary</b></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üìö Workshop 2025</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üéì Martini Lectures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üõ†Ô∏è Hands-on Tutorials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Legacy/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üï∏Ô∏è Legacy Material</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#complex-mixtures-with-insane" id="toc-complex-mixtures-with-insane" class="nav-link" data-scroll-target="#complex-mixtures-with-insane">Complex mixtures with Insane</a></li>
  <li><a href="#adding-a-new-lipid-headgroup-lysyl-pg" id="toc-adding-a-new-lipid-headgroup-lysyl-pg" class="nav-link" data-scroll-target="#adding-a-new-lipid-headgroup-lysyl-pg">Adding a new lipid headgroup: lysyl-PG</a></li>
  <li><a href="#tools-and-scripts-used-in-this-tutorial" id="toc-tools-and-scripts-used-in-this-tutorial" class="nav-link" data-scroll-target="#tools-and-scripts-used-in-this-tutorial">Tools and scripts used in this tutorial</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lipid bilayers - Part II: Complex mixtures</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<hr>
<p>In case of issues, please contact <a href="mailto:%20luis.borges@ens-lyon.fr">Lu√≠s Borges-Ara√∫jo</a> or <a href="mailto:%20m.n.melo@itqb.unl.pt">Manuel N. Melo</a>.</p>
<hr>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<ul>
<li><a href="#introduction"><code>Introduction</code></a></li>
<li><a href="#complex-mixtures-with-insane"><code>Complex mixtures with Insane</code></a>
<ul>
<li><a href="#analysis-hexagonality"><code>Analysis ‚Äî hexagonality</code></a></li>
</ul></li>
<li><a href="#adding-a-new-lipid-headgroup-lysyl-pg"><code>Adding a new lipid headgroup: lysyl-PG</code></a>
<ul>
<li><a href="#creating-the-lysyl-pg-topology"><code>Creating the lysyl-PG topology</code></a></li>
<li><a href="#adding-lysyl-pg-to-insane"><code>Adding lysyl-PG to Insane</code></a></li>
</ul></li>
<li><a href="#tools-and-scripts-used-in-this-tutorial"><code>Tools and scripts used in this tutorial</code></a></li>
<li><a href="#references"><code>References</code></a></li>
</ul>
</section>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<hr>
<p>When setting up large and/or complex bilayers it can be more convenient, or necessary, to start with a bilayer close to equilibrium rather than trying to get the bilayer to self-assemble. This can be done by concatenating (e.g., using <code>gmx genconf</code>) and/or altering previously formed bilayers, but an easier approach is to use a bilayer formation program such as <code>Insane</code><sup><a href="#references">[1]</a></sup> (available from the <a href="../../../../docs/downloads/tools/topology-structure-generation.html">Downloads -&gt; Tools</a> section of the website, as <code>pip install --user insane</code>, or from its <a href="https://github.com/Tsjerk/Insane">GitHub repo</a>).</p>
<hr>
<blockquote class="blockquote">
<p><strong><em>Note:</em></strong> Because very recent (as of writing) lipid parameters will be employed, the latest <code>Insane</code> version from the <a href="https://github.com/Tsjerk/Insane">GitHub repo</a> will be used.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong><em>Note:</em></strong> This tutorial assumes you are familiar with running Martini 3 simulations with GROMACS, and with the organization of the particle and molecule topologies bundled with the Martini 3 release. For a lipid-centered primer on these topics you can run the Lipid Bilayers I tutorial. Additionally, depending on the version of <code>insane</code> you run, and on whether you run the supplied analyses, you will need to have installed the <code>numpy</code> and <code>MDAnalysis</code> Python packages. If needed, you can typically install them via <code>pip</code> by running <code>pip3 install --user numpy mdanalysis</code>.</p>
</blockquote>
<hr>
</section>
<section id="complex-mixtures-with-insane" class="level3">
<h3 class="anchored" data-anchor-id="complex-mixtures-with-insane">Complex mixtures with Insane</h3>
<hr>
<p><code>Insane</code> (INSert membrANE) is a CG building tool that generates membranes by distributing lipids over a grid. Lipid structures are derived from simple template definitions. Many are already included with the program (see below on how to add new ones). The program uses two grids, one for the inner and one for the outer leaflet, and distributes the lipids randomly over the grid cells with numbers according to the relative quantities specified. This allows for building asymmetric bilayers with specific lipid compositions. The program also allows for adding solvent and ions, using a similar grid protocol to distribute them over a 3D grid. Finally, the <code>Insane</code> script can also be used to set up a complex (or simple!) bilayer system including membrane proteins. Additional information about the functionality of <code>Insane</code> can be found by running <code>insane -h</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><code>COBY</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>While <code>Insane</code> is the most widely used tool for membrane building in Martini (and the one used in this tutorial), an alternative is <code>COBY</code>. <code>COBY</code> is a Python-based tool for building flat coarse-grained membranes, supporting asymmetric and phase-separated systems, multiple bilayers, protein insertion, solvation, and solvation with one or more chosen solutes. Versatile and highly customizable, it is particularly well-suited for more complex system setups; however, it is outside the scope of this tutorial. More information, including features and example systems, can be found on the <a href="https://github.com/MikkelDA/COBY"><code>COBY</code> GitHub repository</a>.</p>
</div>
</div>
<p>Because <code>Insane</code> deals mostly with structure generation, it can be used for both Martini 2 and 3 lipids, to the extent that they keep the same number of beads and mapping. However, beware that this may not be always true for future Martini 3 lipid models. Conversely, not all the lipid types you‚Äôll find available in <code>Insane</code> have been implemented in Martini 3.</p>
<p>As with other tutorials, this one offers a worked version with all the intermediate steps <a href="https://cgmartini-library.s3.ca-central-1.amazonaws.com/0_Tutorials/m3_tutorials/LipidsII/bilayer-lipidome-tutorial-II_worked.tgz">bilayer-lipidome-tutorial-II_worked.tgz</a>, and a bare one, that expects you to do and simulate more <a href="https://cgmartini-library.s3.ca-central-1.amazonaws.com/0_Tutorials/m3_tutorials/LipidsII/bilayer-lipidome-tutorial-II_minimal.tgz">bilayer-lipidome-tutorial-II_minimal.tgz</a>. Unpack the tutorial‚Äôs archive and enter the subdirectory <code>bilayer-lipidome-tutorial-II/minimal/complex-bilayers/</code> or <code>bilayer-lipidome-tutorial-II/worked/complex-bilayers/</code>.</p>
<p>We will create with <code>Insane</code> a fully hydrated 2:1 mole ratio bilayer of dibehenoyl-phosphatidylcholine (DBPC) : dilinoleyl-phosphatidylcholine (DLPC), with physiological ion concentrations. DBPC has long saturated chains (22:0), whereas DLPC‚Äôs are shorter and polyunsaturated (18:2). Because of its saturation, DBPC has a gel-to-liquid transition temperature of 348 K; DLPC‚Äôs transition occurs at 216 K<sup><a href="#references">[2]</a></sup>. By simulating a mixture of these lipids at an intermediate temperature, we can expect the formation of two coexisting phases: a gel one enriched in DBPC, and a liquid one enriched in DLPC. In this tutorial we will be running a simulation at 290K, using DBPC and DLPC as opposite extremes to ensure a successful separation.</p>
<hr>
<blockquote class="blockquote">
<p><strong><em>Note:</em></strong> The initial Martini 3 lipid parameters were not always able to correctly reproduce this sort of phase separation when lipid transition temperatures were closer together. However, the lipid parameters were updated and greatly expanded in 2025<sup><a href="#references">[3]</a></sup> and such phase separation is now attainable. This tutorial uses the updated parameters, but still focuses on the DBPC:DLPC extremes to allow for meaningful results in a shorter simulation time.</p>
</blockquote>
<hr>
<p>As of writing, the PyPi <code>Insane</code> releases do not yet work with the updated Martini 3 lipid parameters. We will therefore employ the latest version from <a href="https://github.com/Tsjerk/Insane">the <code>Insane</code> GitHub repo</a>. Still, this version does not know the details of DLPC, which we will supplement.</p>
<p>Start by installing the latest <code>Insane</code>, using <code>pip</code> from <a href="https://github.com/Tsjerk/Insane">its GitHub repo</a>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">--force-reinstall</span> <span class="at">--no-deps</span> simopt git+https://github.com/Tsjerk/Insane.git</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then download the Martini 3 particle definitions and solvent/ion topologies, as well as the required <code>.itp</code> files for the updated lipid parameters:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://cgmartini-library.s3.ca-central-1.amazonaws.com/1_Downloads/ff_parameters/martini3/martini_v300.zip</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span> martini_v300.zip <span class="at">-x</span> __MACOSX/<span class="pp">*</span> <span class="pp">*</span>/.DS_Store</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> martini_v300/martini_v3.0.0.itp martini_v300/martini_v3.0.0_ions_v1.itp martini_v300/martini_v3.0.0_solvents_v1.itp .</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/Martini-Force-Field-Initiative/M3-Lipid-Parameters/raw/refs/heads/main/ITPs/martini_v3.0.0_ffbonded_v2.itp</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/Martini-Force-Field-Initiative/M3-Lipid-Parameters/raw/refs/heads/main/ITPs/martini_v3.0.0_phospholipids_PC_v2.itp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The custom <code>Insane</code> has settings for DBPC but not DLPC. It accepts a number of flags with which you can specify a new lipid (the <code>-al*</code> flags; read more with <code>-h</code>). Unfortunately, a <a href="https://github.com/Tsjerk/Insane/pull/95">bug</a> causes <code>Insane</code> to mislabel tail bead names of added lipids. As an alternative way to correctly add a lipid definition to <code>Insane</code>, we will directly edit its database (this will be also be useful for the exercise ahead when we‚Äôll <a href="#adding-a-new-lipid-headgroup-lysyl-pg">add a new lipid type</a>). First we must find the <code>Insane</code> installation directory by running:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-c</span> <span class="st">'import insane; print(insane.__path__[0])'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In that directory look for the file <code>lipids.dat</code>. Edit it and find the section of <code>[ diacylglycerol ]</code>. Add the following line to that list of lipids (order won‚Äôt matter, but it makes sense to put it next to other <code>PC</code> lipids):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">M3.DLPC</span>   0   <span class="at">-</span>   <span class="at">-</span>   <span class="at">-</span>  NC3  <span class="at">-</span>  PO4 GL1 GL2 C1A D2A D3A C4A  <span class="at">-</span>   <span class="at">-</span>  C1B D2B D3B C4B  <span class="at">-</span>   <span class="at">-</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>You can then run <code>Insane</code> to build the starting membrane:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">insane</span> <span class="at">-salt</span> 0.15 <span class="at">-x</span> 20 <span class="at">-y</span> 10 <span class="at">-z</span> 10 <span class="at">-sol</span> W <span class="at">-o</span> membrane.gro <span class="at">-l</span> DBPC:2 <span class="at">-l</span> DLPC:1 <span class="at">-p</span> topol.top</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This will generate an initial configuration for the system <code>membrane.gro</code> (Fig. 1A) and a starting point for a working topology <code>topol.top</code>, which you must complete and correct:</p>
<ul>
<li>It may have an include referring to a generic <code>martini.itp</code> (it should instead point to <code>martini_v3.0.0.itp</code>);</li>
<li>You must also <code>#include</code> the downloaded <code>martini_v3.0.0_ffbonded_v2.itp</code> and <code>martini_v3.0.0_phospholipids_PC_v2.itp</code> (in this order, but after <code>martini_v3.0.0.itp</code>).</li>
</ul>
<p>Then, energy-minimize the structure using the provided <code>em.mdp</code> file.</p>
<p>After minimization we directly run a production simulation at 20 fs time step (with <code>md.mdp</code>). Skipping direclty to production is possible because, since GROMACS 2021 and the introduction of the the <code>C-rescale</code> barostat, pressure/temperature schemes are the same for pressure/temperature equilibration and for subsequent production. We must bear in mind that during the initial nanoseconds of this run, the grid order imposed by <code>Insane</code> (Fig. 1A) will still be relaxing (Fig. 1B), as will the pressure and temperature. Also, because this simulation contains multiple components you will have to make an index file (using <code>gmx make_ndx</code>) and group all the lipids together and all the solvent (water and ions) together to fit the specified groups in the <code>.mdp</code> files; the provided <code>.mdp</code> files expect the index group names <code>Bilayer</code> and <code>Solvent</code>.</p>
<p>This DBPC:DLPC mixture separates in a couple hundred ns at a temperature of 290 K (Fig. 1C,D,E). If you don‚Äôt want to wait that long for your simulation, a sample run is provided for you under <code>phase_sep.xtc</code> (if you‚Äôre not using the ‚Äòworked‚Äô tutorial files, you can get it <a href="https://cgmartini-library.s3.ca-central-1.amazonaws.com/0_Tutorials/m3_tutorials/LipidsII/phase_sep.xtc">from here</a>, as well as a compatible <code>phase_sep.tpr</code> <a href="https://cgmartini-library.s3.ca-central-1.amazonaws.com/0_Tutorials/m3_tutorials/LipidsII/phase_sep.tpr">from here</a>). If you do run the simulation, take the time to revisit <code>Insane</code>‚Äôs <code>lipids.dat</code> and understand its structure.</p>
<hr>
<blockquote class="blockquote">
<p><strong><em>Note:</em></strong> As <code>Insane</code> places lipids and solvent on a grid, they can still be in an energetically unfavorable state even after minimization. Due to the large forces involved it is sometimes (but not always) necessary to run a few equilibrium simulations using a short time step (1-10 fs) before running production simulations at the standard 20-fs Martini time step. The lipids used in this exercise should not require such intermediate equilibration.</p>
</blockquote>
<hr>
<p>If you have VMD installed and name your <code>.tpr</code> file and output <code>trajectory phase_sep.tpr</code>, <code>phase_sep.xtc</code>, respectively (hint: pass the <code>-deffnm phase_sep</code> flag to <code>gmx mdrun</code>, or rename the files after the simulation), you can load a visualization similar to that in Fig. 1 by running the <code>do_vmd.sh</code> script. Note that that visualization has several representations that are hidden (text in red) and that can be enabled by double-clcking on them.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Fig1.png" class="img-fluid figure-img"></p>
<figcaption>Figure 1 | Gel-liquid phase separation in a 2:1 DBPC:DLPC mixture. A) Structure immediately after construction by <code>Insane</code> B) After energy minimization and 500 ps of simulation the grid structure is no longer visible. C,D,E) After 200 ns at 290 K this lipid mixture has phase separated into ld and so domains; D and E show the top view of the simulation, and in E only the first bead of each acyl tail of the top leaflet is represented, highlighting the gel-phase hexagonal packing (VMD‚Äôs use of multi-frame position averaging further highlights the honeycomb pattern). In all panels DBPC is in blue and DLPC in red.</figcaption>
</figure>
</div>
<section id="analysis-hexagonality" class="level4">
<h4 class="anchored" data-anchor-id="analysis-hexagonality">Analysis ‚Äî hexagonality</h4>
<hr>
<p>This system can be subjected to several types of analysis (see the <a href="../../../../docs/tutorials/Martini3/LipidsI/index.html">Lipid Bilayers I tutorial</a> for general examples). Some specific analyses can be used to characterize this phase separation. Namely, those that look at lipid order and contacts (sadly, the <code>do_order</code> script you may have used in the Lipid Bilayers I tutorial is not compatible with lipid mixtures). Here we‚Äôll quantify the ‚Äòhexagonality‚Äô of the lipid tail packing along the phase transition. In this measurement, that looks only at the tails‚Äô first beads (see Fig 1B to understand why), a lipid tail is said to be hexagonally packed if:</p>
<ul>
<li>its first bead has at least 6 neighboring beads within 6 √Ö;</li>
<li>all of its 6 closest neighbors have themselves at least 2 neighbors within 6 √Ö.</li>
</ul>
<p>These criteria may yield some false positives and some false negatives, but are simple enough for this application (beware that different studies may employ different criteria for hexagonality). The script <code>hexagonality.py</code> computes this for you, for every frame, and outputs a <code>hexagonality.xvg</code> that you can quickly plot with xmgrace. Make the script executable, if needed, and run it:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./hexagonality.py</span> <span class="at">-f</span> phase_sep.xtc <span class="at">-s</span> phase_sep.tpr</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">xmgrace</span> hexagonality.xvg</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Appreciate the quantitative view of the degree of phase separation / gel formation along time. Does the fraction of hexagonally packed tails match your expectation given that DBPC makes up two-thirds of this system?</p>
<p>You have now prepared, simulated and analyzed a phase-separating binary mixture of DLPC and DBPC lipids. Molecular simulations have a limited numerical accuracy, and this can sometimes create temperature imbalances ‚Äî particularly in phase-separating systems<sup><a href="#references">[4]</a></sup>. As an extra step, it would be wise to also check the temperature of the separated parts and see if there are any imbalances limiting or exacerbating the phase separation.</p>
</section>
</section>
<section id="adding-a-new-lipid-headgroup-lysyl-pg" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-new-lipid-headgroup-lysyl-pg">Adding a new lipid headgroup: lysyl-PG</h3>
<hr>
<p>When working with complex lipid bilayer systems, you might find that your lipid of interest is not yet available in the Martini lipidome. If so, it might be necessary for you to parameterize a lipid headgroup yourself. In this part of the tutorial, we will outline how new lipid headgroups can be parameterized and leveraged to create complex bilayer systems, using Lysyl-PG as an example.</p>
<p>Lysyl-PG (lysyl-phosphatidylglycerol) is a membrane lipid in several gram-positive bacteria, such as <em>Staphylococcus aureus</em>, which confers a higher level of antimicrobial resistance to cationic host defense peptides<sup><a href="#references">[5]</a></sup>. Lysyl-PG consists of the ester of phosphatidylglycerol (PG) with the amino acid lysine (Fig 2). However, even though the lysine and PG topologies are available for Martini 3, there is no conjugated lysyl-PG topology yet.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Fig2.png" class="img-fluid figure-img"></p>
<figcaption>Figure 2 | Structure of the Lysyl-PG headgroup.</figcaption>
</figure>
</div>
<section id="creating-the-lysyl-pg-topology" class="level4">
<h4 class="anchored" data-anchor-id="creating-the-lysyl-pg-topology">Creating the lysyl-PG topology</h4>
<hr>
<p>Enter the directory <code>new-headgroup/</code> within the tutorial‚Äôs archive. Start by obtaining the Martini 3 topology files (either from the directory of the previous exercise or by re-downloading their archive and unziping it). You must also download the <code>.itp</code> file with the updated lipid parameters for PG:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/Martini-Force-Field-Initiative/M3-Lipid-Parameters/raw/refs/heads/main/ITPs/martini_v3.0.0_phospholipids_PG_v2.itp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To create the lysyl-PG topology, we will combine the pre-existing Martini 3 topologies of lysine and of the POPG lipid. We will employ a simple conjugation, assuming a bond between the amino acid backbone (<code>BB</code>) and the PG glycerol (<code>GL0</code>) with the same characteristics as the phosphate ‚Äì glycerol bond (<code>PO4 -- GL0</code>) already in place. Find the topology for POPG within the Martini 3 PG phospholipid topologies (<code>martini_v3.0.0_phospholipids_PG_v2.itp</code>), as well as the topology for lysine within the Martini 3 amino acid topology file (<code>martini_v300/martini_v3.0.0_proteins/force_fields/martini3001/aminoacids.ff</code>). Create a new file named <code>lysylPG.itp</code> and copy over the two topologies. Note that the topology in <code>martini_v300/martini_v3.0.0_proteins/force_fields/martini3001/aminoacids.ff</code> is in the format of the <a href="https://github.com/marrink-lab/vermouth-martinize">Vermouth</a> software, which is slightly different from that of <code>GROMACS</code> (for instance, <code>$prot_default_bb_type</code> is a macro that is replaced by <code>P2</code>).</p>
<p>Take a moment to look at the two topologies. These two must now be combined onto a single one, taking care not to break any of the bonded parameters already in place. The simplest way of doing this is by using the POPG topology as a template and adding the lysine parameters on top. As such, start by renaming the molecule by changing the name in the <code>[ moleculetype ]</code> section to POLPG. We can then start merging the <code>[ atoms ]</code> section by adding the list of lysine atoms/beads to the top of the POPG atoms already in place. Care must now be taken to correctly renumber all of the atom entries as well as to change the residue names to POLPG.</p>
<p>Initially, your <code>[ moleculetype ]</code> and <code>[ atoms ]</code> sections should look something like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> moleculetype <span class="bu">]</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">molname</span> nrexcl</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">POLPG</span> 1</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> atoms <span class="bu">]</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="fu">id</span> type resnr residu atom cgnr charge</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>   <span class="ex">1</span>   P2    1  POLPG   BB   1    0   <span class="kw">;</span><span class="ex">Lysine</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>   <span class="ex">2</span>  SC3    1  POLPG  SC1   2    0</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>   <span class="ex">3</span> SQ4p    1  POLPG  SC2   3  1.0</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>   <span class="ex">4</span>  P4r    1  POLPG  GL0   4    0   <span class="kw">;</span><span class="ex">POPG</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>   <span class="ex">5</span>   Q5    1  POLPG  PO4   5 <span class="at">-1.0</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>   <span class="ex">6</span> SN4a    1  POLPG  GL1   6    0</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>   <span class="ex">7</span> SN4a    1  POLPG  GL2   7    0</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>   <span class="ex">8</span>   C1    1  POLPG  C1A   8    0</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">continues</span> ...<span class="kw">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Now take a look at the bonded parameters in place in the <code>[ bonds ]</code> and <code>[ angles ]</code> sections. Notice that since we renumbered the atom list, the POPG bonded parameters no longer correspond to the correct atoms/beads. To fix this we simply need to update the numbering on the bonded potentials to the current bead numbers:</p>
<blockquote class="blockquote">
<p>The previous harmonic bond definition:</p>
</blockquote>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> bonds <span class="bu">]</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">...</span><span class="kw">)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span> 2 b_GL0_PO4_def</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">...</span><span class="kw">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<blockquote class="blockquote">
<p>After renumbering it will now be:</p>
</blockquote>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> bonds <span class="bu">]</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">...</span><span class="kw">)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="ex">4</span> 5 b_GL0_PO4_def</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">...</span><span class="kw">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>(note the use of macros representing the lipid bonded parameters; these macros are defined in <code>martini_v3.0.0_ffbonded_v2.itp</code>. Macros can be used in the same <code>.itp</code> alongside numerical parameters, such as those for the lysine bonds/angles.)</p>
<p>Renumber the POPG bonded parameters in the <code>[ bonds ]</code> and <code>[ angles ]</code> sections. After you‚Äôve done this we can now add the lysine bonded parameters. The lysine topology contains 2 bonds and 1 angle potential. Since we added the lysine atoms/beads first in the <code>[ atoms ]</code> section we can simply add those to the list without needing to renumber them.</p>
<p>At this point we will now have the two topologies fully merged, however, the lysine and POPG moieties are not yet connected together! To connect them we must add an additional bonded potential, linking the POPG glycerol (<code>GL0</code>) to the lysine backbone (<code>BB</code>). To do this we will assume that the bond in place is similar to the <code>PO4 -- GL0</code> in place. As such, create a new bonded potential linking the <code>GL0</code> and <code>BB</code> beads with the same potential as that of the <code>PO4 -- GL0</code> bond. Note that now that the glycerol group of the PG moiety is forming an ester bond with the lysine backbone, the chemical properties of the <code>GL0</code> bead will be different from those when it was free. As such, we must change the bead type to account for the decrease in polarity from the loss of the hydroxyl group. Taking other Martini 3 models as examples, and with inspiration from the ‚ÄúMartini 3.0 Bible‚Äù<sup><a href="#references">[6]</a></sup> we can tentatively lower the <code>GL0</code> bead‚Äôs polarity from P4r polarity to P1. Additionally, the lysyl <code>BB</code> bead should behave as having a protonated NH<sub>3</sub><sup>+</sup> group, which warrants changing its type from P2 to Q5 and setting its charge to +1. The lysyl-PG topology is now complete.</p>
<hr>
<blockquote class="blockquote">
<p><strong><em>Note</em></strong> that this was a ‚Äúcoarse‚Äù approach to the parameterization of a lipid headgroup, where some assumptions were made for the sake of simplicity and brevity (e.g.&nbsp;assuming the <code>GL0 -- BB</code> ester bond behaves as the <code>PO4 -- GL0</code> bond, assuming lysine conformation dynamics remain the same when bonded to POPG, assuming the modified glycerol moiety is correctly represented by a P1 bead, etc.). However, this model could serve as a starting point for the refinement of a finer, more accurate model, focusing on the linkage details: bonds, angles, and dihedrals, as well as a finer tuning of the glycerol bead particle type. Refinements of lipid models typically use atomistic MD models of the same lipid as reference for their conformational dynamics<sup><a href="#references">[3]</a></sup>. Additionally, other theoretical or experimental parameters are also used as reference targets, such as area per lipid, membrane thickness, etc. Refer to the tutorials on small molecule parameterization where some of these aspects are tackled in more detail.</p>
</blockquote>
</section>
<section id="adding-lysyl-pg-to-insane" class="level4">
<h4 class="anchored" data-anchor-id="adding-lysyl-pg-to-insane">Adding lysyl-PG to <code>Insane</code></h4>
<hr>
<p>Having created a topology for lysyl-PG we now want to incorporate it in bilayers assembled by <code>Insane</code>. However, since this is a new lipid topology, there are no available templates for our lysyl-PG lipid in insane, and we must define it ourselves.</p>
<p>Lipids in <code>Insane</code> are defined schematically, based on templates. These templates roughly define the x,y,z pseudocoordinates for each of the CG beads. Adding a new template to <code>Insane</code> is as simple as defining the position of each of the lipid beads in this pseudocoordinate system. Due to its smooth energy landscape, Martini is quite robust and much more tolerant to distortions of the starting structures than, for example, atomistic simulations. This allows us to construct complex membranes from very simple lipid templates. (See the <code>Insane</code> publication for more details<sup><a href="#references">[1]</a></sup>.) While different versions of <code>Insane</code> have slightly different template formatting, the overall approach is very similar.</p>
<p>Use your text editor of choice to open the <code>lipids.dat</code> file under the <code>Insane</code> python installation directory (as done <a href="#complex-mixtures-with-insane">above</a>). Look for the <code>[ diacylglycerol ]</code> template and the DPPC definition:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> diacylglycerol <span class="bu">]</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">PROTOLIPID</span> <span class="er">(</span><span class="ex">diacylglycerol</span><span class="kw">)</span><span class="ex">,</span> 18 beads</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">1-3-4-6-7--9-10-11-12-13-14</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span>  <span class="ex">\|</span> <span class="kw">|</span><span class="ex">/</span>  <span class="kw">|</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span>   <span class="ex">2</span> 5   8-15-16-17-18-19-20</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>           <span class="ex">0</span>  .5   0   0  .5   0   0  .5   0   0   0   0   0   0   1   1   1   1   1   1</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>           <span class="ex">0</span>   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>          <span class="ex">10</span>   9   9   8   8   7   6   6   5   4   3   2   1   0   5   4   3   2   1   0</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span>          <span class="ex">1</span>   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">Martini</span> 3 types</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">...</span><span class="kw">)</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="ex">M3.DPPC</span>   0   <span class="at">-</span>   <span class="at">-</span>   <span class="at">-</span>  NC3  <span class="at">-</span>  PO4 GL1 GL2 C1A C2A C3A C4A  <span class="at">-</span>   <span class="at">-</span>  C1B C2B C3B C4B  <span class="at">-</span>   <span class="at">-</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">...</span><span class="kw">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>A lipid template is defined by setting the relative x,y,z pseudocoordinates for each of the particles in the pseudotemplate in <code>lipidsx</code>, <code>lipidsy</code> and <code>lipidsz</code>, respectively (these are the three non-comment lines immediately after <code>[ diacylglycerol ]</code>). Each lipid entry will then populate the particles in the template as required. If you scroll around <code>lipids.dat</code> you will notice that some families of lipids will have their own templates, such as glycolipids or cardiolipins.</p>
<p>The order in which the atoms are defined in the topology matters when defining the lipid template. While lipid atoms in Martini are typically roughly ordered from top to bottom (outermost headgroup bead to innermost acyl chain bead) this may not always be the case (e.g.&nbsp;phosphoinositol phosphates are defined after the headgroup sugar ring when they are typically the outermost beads). This is also the case with our lysyl-PG topology, where the backbone bead (<code>BB</code>) is defined before the most superficial <code>SC2</code> bead. While we could re-order and adapt our topology to fit one of the pre-existing templates, we will create our own template specific to lysyl-PG.</p>
<p>Start by drawing out the template for lysyl-PG, using the <code>[ diacylglycerol ]</code> template as a guide. If you are struggling with visualizing the structure, pen and paper are your friends! Having drawn the template, assign x,y,z pseudocoordinates for each of the beads, based on the preexisting templates. In our case, every bead from the phosphate bead (PO4) down should match the default diacylglycerol template. Do not pay too much attention to the precise distances between beads since, as it was previously mentioned, Martini is quite robust in handling rough starting conformations. Distances of 0.5 or 1 between beads are typical.</p>
<p>While it is worth noting that there are many valid templates, in the end, your lysyl-PG template should look something like this (note the difference in z-positions relative to the existing diacylglycerol template):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> lysylpg <span class="bu">]</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">PROTOLIPID</span> <span class="er">(</span><span class="ex">lysyl-phosphatidylglycerol</span><span class="kw">)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">3</span>  1--4--5--6--8--9--10--11--12--13     SC2  BB--GL0--PO4--GL1--C1A--<span class="er">(</span><span class="ex">...</span><span class="kw">)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span>  <span class="ex">\ </span><span class="kw">|</span>      <span class="ex">\ </span><span class="kw">|</span>                              <span class="ex">\ </span><span class="kw">|</span>           <span class="ex">\ </span> <span class="kw">|</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span>   <span class="ex">2</span>        7--14--15--16--17--18--19       SC1             GL2--C1B--<span class="er">(</span><span class="ex">...</span><span class="kw">)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>               <span class="ex">0</span>  .5   0   0   0   0  .5   0   0   0   0   0   0   1   1   1   1   1   1  </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>               <span class="ex">0</span>   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>               <span class="ex">9</span>   9  10   8   7   6   6   5   4   3   2   1   0   5   4   3   2   1   0</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">bead</span> number: 1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="ex">M3.POLPG</span>   1   BB SC1 SC2 GL0 PO4 GL1 GL2 C1A D2A C3A C4A  <span class="at">-</span>   <span class="at">-</span>  C1B C2B C3B C4B  <span class="at">-</span>   <span class="at">-</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">M3</span> indicates this template will be used when the Martini 3 FF is asked for <span class="er">(</span><span class="fu">which</span> is the default<span class="kw">)</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">The</span> numeric <span class="st">'1'</span> field is the lipid<span class="st">'s overall charge</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>If you‚Äôve correctly added this entry to <code>lipids.dat</code>, you should now be able to assemble membranes containing lysyl-PG. Try assembling a membrane composed of 5:1 POPG:POLPG using <code>Insane</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">insane</span> <span class="at">-salt</span> 0.15 <span class="at">-l</span> POPG:5 <span class="at">-l</span> POLPG:1 <span class="at">-x</span> 20 <span class="at">-y</span> 10 <span class="at">-z</span> 10 <span class="at">-sol</span> W <span class="at">-charge</span> auto <span class="at">-sol</span> W <span class="at">-o</span> membrane.gro <span class="at">-p</span> topol.top</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use it as a starting point to run a simulation with this membrane mixture, following the steps <a href="#complex-mixtures-with-insane">above</a> (set the temperature to 300 K and total run time to 50 ns). Because we specify the lipid‚Äôs charge in the <code>lipids.dat</code> database, we can use <code>Insane</code>‚Äôs <code>-salt</code> and <code>-charge</code> flags to set ionic strength and system neutralization in one go.</p>
<p>You now have a topology for a custom lipid, implemented in a way to be flexibly used by <code>insane</code> for quick membrane building. Good job! When doing this with real-life cases of new lipids, don‚Äôt forget to share your parameters with the community for added impact!</p>
</section>
</section>
<section id="tools-and-scripts-used-in-this-tutorial" class="level3">
<h3 class="anchored" data-anchor-id="tools-and-scripts-used-in-this-tutorial">Tools and scripts used in this tutorial</h3>
<hr>
<ul>
<li><code>GROMACS</code> (<a href="http://www.gromacs.org/" class="uri">http://www.gromacs.org/</a>)</li>
<li><code>Insane</code> (latest version from the <a href="https://github.com/Tsjerk/Insane">GitHub repo</a>)</li>
</ul>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<hr>
<p>[1] Wassenaar, T. A., Ing√≥lfsson, H. I., et al.&nbsp;Computational Lipidomics with insane: A Versatile Tool for Generating Custom Membranes for Molecular Simulations (2015) J. Chem. Theory Comput. 11, 2144‚Äì2155. DOI:10.1021/acs.jctc.5b00209</p>
<p>[2] Thermotropic Phase Transitions of Pure Lipids in Model Membranes and Their Modifications by Membrane Proteins, Dr.&nbsp;John R. Silvius, Lipid-Protein Interactions, John Wiley &amp; Sons, Inc., New York, 1982</p>
<p>[3] Pedersen, K. B., Ing√≥lfsson, H. I., et al.&nbsp;(2025) The Martini 3 Lipidome: Expanded and Refined Parameters Improve Lipid Phase Behavior. ACS Cent. Sci. DOI:10.1021/acscentsci.5c00755</p>
<p>[4] Thallmair, S., Javanainen, M., F√°bi√°n, F., Martinez-Seara, H., Marrink, S.J., Nonconverged Constraints Cause Artificial Temperature Gradients in Lipid Bilayer Simulations (2021) J. Phys. Chem. B 125(33), 9537‚Äì9546. DOI:10.1021/acs.jpcb.1c03665</p>
<p>[5] Kilelee, E., Pokorny, Y., Yeaman, M. R., and Bayer, A. S. Lysyl-Phosphatidylglycerol Attenuates Membrane Perturbation Rather than Surface Association of the Cationic Antimicrobial Peptide 6W-RP-1 in a Model Membrane System: Implications for Daptomycin Resistance (2010) Antimicrob. Agents Chemother. 54, 4476‚Äì4479. DOI:10.1128/AAC.00191-10</p>
<p>[6] Souza, P. C. T., Alessandri, R., et al.&nbsp;(2021) Martini 3: a general purpose force field for coarse-grained molecular dynamics. Nat. Methods 18, 382‚Äì388. DOI: 10.1038/s41592-021-01098-3</p>
<hr>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/cgmartini\.nl");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<div class="footer-left">

</div>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Martini-Force-Field-Initiative">
      <i class="bi bi-github" role="img" aria-label="Martini GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../docs/faq/index.html">
<p><iconify-icon inline="true" role="img" icon="hugeicons:help-circle" style="font-size: 1.25em;" aria-label="FAQs" title="FAQs"></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/cg_martini">
      <i class="bi bi-twitter-x" role="img" aria-label="Martini Twitter">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
<div class="footer-right">
¬© 2025 Martini Force Field Initiative <img src="https://cgmartini-library.s3.ca-central-1.amazonaws.com/icon.png" alt="Icon">
</div>
</div>
  </div>
</footer>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const quotes = [
          "<i>Shaken, not stirred.</i> - James Bond",
          "<i>He was white and shaken, like a dry martini.</i> - P. G. Wodehouse",      
          "<i>I think people think we're all sipping martinis by the pool.</i> - Maria Menounos",
          "<i>Why don't you get out of that wet coat and into a dry martini?</i> - Robert Benchley",
          "<i>Really, can anyone drink several martinis at lunch?</i> - Christine Baranski",
          "<i>Zen martini: A martini with no vermouth at all. And no gin, either.</i> - P.J. O'Rourke",
          "<i>I never go jogging, it makes me spill my martini.</i> - George Burns",
          "<i>Martinis are the only American invention as perfect as a sonnet.</i> - H. L. Mencken",
          "<i>He knows just how I like my martini: full of alcohol.</i> - Homer Simpson",
          "<i>Happiness is: finding olives in your martini when you're hungry.</i> - Johnny Carson",
          "<i>If it wasn't for the olives in his martinis he'd starve to death.</i> - Milton Berle",
        ];
      const randomIndex = Math.floor(Math.random() * quotes.length);
      const randomQuote = quotes[randomIndex];

      const footerLeft = document.querySelector('.footer-left');
      if (footerLeft) {
          footerLeft.innerHTML = randomQuote;
      }
    });
</script>
<script src="../../../../js/sidebar-close.js"></script> 




</body></html>