<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Protein complex models ‚Äì Martini Force Field Initiative</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../images/favicon.png" rel="icon" type="image/png">
<script src="../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-5bdfcfc43d5b74b085d09162bedc61ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../../../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const quotes = [
          "<i>Shaken, not stirred.</i> - James Bond",
          "<i>He was white and shaken, like a dry martini.</i> - P. G. Wodehouse",      
          "<i>I think people think we're all sipping martinis by the pool.</i> - Maria Menounos",
          "<i>Why don't you get out of that wet coat and into a dry martini?</i> - Robert Benchley",
          "<i>Really, can anyone drink several martinis at lunch?</i> - Christine Baranski",
          "<i>Zen martini: A martini with no vermouth at all. And no gin, either.</i> - P.J. O'Rourke",
          "<i>I never go jogging, it makes me spill my martini.</i> - George Burns",
          "<i>Martinis are the only American invention as perfect as a sonnet.</i> - H. L. Mencken",
          "<i>He knows just how I like my martini: full of alcohol.</i> - Homer Simpson",
          "<i>Happiness is: finding olives in your martini when you're hungry.</i> - Johnny Carson",
          "<i>If it wasn't for the olives in his martinis he'd starve to death.</i> - Milton Berle",
        ];
      const randomIndex = Math.floor(Math.random() * quotes.length);
      const randomQuote = quotes[randomIndex];

      const footerLeft = document.querySelector('.footer-left');
      if (footerLeft) {
          footerLeft.innerHTML = randomQuote;
      }
    });
</script>


<link rel="stylesheet" href="../../../../styles.css">
<meta property="og:title" content="Protein complex models ‚Äì Martini Force Field Initiative">
<meta property="og:description" content="">
<meta property="og:image" content="https://cgmartini.nl/docs/tutorials/Martini3/ProteinsIIb/AA.png">
<meta property="og:site_name" content="Martini Force Field Initiative">
<meta property="og:image:alt" content="alt text">
<meta property="og:image:height" content="600">
<meta property="og:image:width" content="600">
<meta name="twitter:title" content="Protein complex models ‚Äì Martini Force Field Initiative">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://cgmartini.nl/docs/tutorials/Martini3/ProteinsIIb/AA.png">
<meta name="twitter:image:alt" content="alt text">
<meta name="twitter:image-height" content="600">
<meta name="twitter:image-width" content="600">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../images/martini.gif" alt="martini logo" class="navbar-logo light-content">
    <img src="../../../../images/martini.gif" alt="martini logo" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../../../index.html" aria-current="page"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/tutorials/index.html"> <i class="bi bi-mortarboard-fill" role="img">
</i> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/downloads/index.html"> <i class="bi bi-download" role="img">
</i> 
<span class="menu-text">Downloads</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/publications/index.html"> <i class="bi bi-newspaper" role="img">
</i> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/announcements/index.html"> 
<span class="menu-text"><i class="fa-solid fa-bullhorn" aria-label="bullhorn"></i> Announcements</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/contact/index.html"> 
<span class="menu-text"><i class="fa-regular fa-address-book" aria-label="address-book"></i> Contact</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-fa-circle-info--help" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i> Help</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-fa-circle-info--help">    
        <li>
    <a class="dropdown-item" href="https://github.com/orgs/Martini-Force-Field-Initiative/discussions"><i class="bi bi-chat-right-text" role="img">
</i> 
 <span class="dropdown-text">Discussion Board</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/orgs/Martini-Force-Field-Initiative/discussions"><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">Report an Issue</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../docs/faq/index.html"><i class="bi bi-question-circle" role="img">
</i> 
 <span class="dropdown-text">FAQs</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/cg_martini" title="Martini Twitter" class="quarto-navigation-tool px-1" aria-label="Martini Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/Martini-Force-Field-Initiative" title="Martini GitHub" class="quarto-navigation-tool px-1" aria-label="Martini GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Protein complex models</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../../../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b>Summary</b></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üìö Workshop 2025</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üéì Martini Lectures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üõ†Ô∏è Hands-on Tutorials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Legacy/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üï∏Ô∏è Legacy Material</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#part-i.-protein-complexes-at-equilibrium" id="toc-part-i.-protein-complexes-at-equilibrium" class="nav-link" data-scroll-target="#part-i.-protein-complexes-at-equilibrium">Part I. Protein complexes at equilibrium</a></li>
  <li><a href="#protein-complex-preparation" id="toc-protein-complex-preparation" class="nav-link" data-scroll-target="#protein-complex-preparation">Protein complex preparation</a></li>
  <li><a href="#protein-complex-without-a-structural-bias" id="toc-protein-complex-without-a-structural-bias" class="nav-link" data-scroll-target="#protein-complex-without-a-structural-bias">Protein complex without a structural bias</a>
  <ul class="collapse">
  <li><a href="#step-1.-generate-coarse-grained-topology" id="toc-step-1.-generate-coarse-grained-topology" class="nav-link" data-scroll-target="#step-1.-generate-coarse-grained-topology">Step 1. Generate coarse-grained topology</a></li>
  <li><a href="#step-2.-set-up-the-simulation-box" id="toc-step-2.-set-up-the-simulation-box" class="nav-link" data-scroll-target="#step-2.-set-up-the-simulation-box">Step 2. Set up the simulation box</a></li>
  <li><a href="#step-3.-solvate-the-system" id="toc-step-3.-solvate-the-system" class="nav-link" data-scroll-target="#step-3.-solvate-the-system">Step 3. Solvate the system</a></li>
  <li><a href="#step-4.-add-ions" id="toc-step-4.-add-ions" class="nav-link" data-scroll-target="#step-4.-add-ions">Step 4. Add ions</a></li>
  <li><a href="#step-5.-energy-minimization" id="toc-step-5.-energy-minimization" class="nav-link" data-scroll-target="#step-5.-energy-minimization">Step 5. Energy minimization</a></li>
  <li><a href="#step-6.-equilibration-under-npt-conditions" id="toc-step-6.-equilibration-under-npt-conditions" class="nav-link" data-scroll-target="#step-6.-equilibration-under-npt-conditions">Step 6. Equilibration under NPT conditions</a></li>
  <li><a href="#step-7.-production-simulation" id="toc-step-7.-production-simulation" class="nav-link" data-scroll-target="#step-7.-production-simulation">Step 7. Production simulation</a></li>
  </ul></li>
  <li><a href="#protein-complex-with-elastic-network" id="toc-protein-complex-with-elastic-network" class="nav-link" data-scroll-target="#protein-complex-with-elastic-network">Protein complex with elastic network</a></li>
  <li><a href="#protein-complex-with-olives" id="toc-protein-complex-with-olives" class="nav-link" data-scroll-target="#protein-complex-with-olives">Protein complex with OLIVES</a></li>
  <li><a href="#protein-complex-with-g≈çmartini-3" id="toc-protein-complex-with-g≈çmartini-3" class="nav-link" data-scroll-target="#protein-complex-with-g≈çmartini-3">Protein complex with G≈çMartini 3</a></li>
  <li><a href="#comparison-between-martini-3-protein-complex-models" id="toc-comparison-between-martini-3-protein-complex-models" class="nav-link" data-scroll-target="#comparison-between-martini-3-protein-complex-models">Comparison between Martini 3 protein complex models</a></li>
  <li><a href="#part-ii.-protein-complex-under-conformational-changes-a-nanomechanical-study" id="toc-part-ii.-protein-complex-under-conformational-changes-a-nanomechanical-study" class="nav-link" data-scroll-target="#part-ii.-protein-complex-under-conformational-changes-a-nanomechanical-study">Part II. Protein complex under conformational changes: A nanomechanical study</a></li>
  <li><a href="#afm-smfs-captured-by-steered-molecular-dynamics-smd-simulation" id="toc-afm-smfs-captured-by-steered-molecular-dynamics-smd-simulation" class="nav-link" data-scroll-target="#afm-smfs-captured-by-steered-molecular-dynamics-smd-simulation">AFM-SMFS captured by Steered Molecular Dynamics (SMD) simulation</a>
  <ul class="collapse">
  <li><a href="#protein-alignment-along-the-z-axis" id="toc-protein-alignment-along-the-z-axis" class="nav-link" data-scroll-target="#protein-alignment-along-the-z-axis">Protein alignment along the Z-axis</a></li>
  <li><a href="#step-2.-set-up-the-simulation-with-a-large-box" id="toc-step-2.-set-up-the-simulation-with-a-large-box" class="nav-link" data-scroll-target="#step-2.-set-up-the-simulation-with-a-large-box">Step 2. Set up the simulation with a large box</a></li>
  <li><a href="#run-the-production-simulation" id="toc-run-the-production-simulation" class="nav-link" data-scroll-target="#run-the-production-simulation">7. Run the production simulation</a></li>
  </ul></li>
  <li><a href="#protein-complex-with-optimized-g≈çmartini-3" id="toc-protein-complex-with-optimized-g≈çmartini-3" class="nav-link" data-scroll-target="#protein-complex-with-optimized-g≈çmartini-3">Protein complex with optimized G≈çMartini 3</a></li>
  <li><a href="#tools-and-scripts-used-in-this-tutorial" id="toc-tools-and-scripts-used-in-this-tutorial" class="nav-link" data-scroll-target="#tools-and-scripts-used-in-this-tutorial">Tools and scripts used in this tutorial</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Protein complex models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<hr>
<p>In case of issues, please contact <a href="mailto:%20fcofas@comunidad.unam.mx">fcofas@comunidad.unam.mx</a> or <a href="mailto:%20apoma@ippt.pan.pl">apoma@ippt.pan.pl</a>.</p>
<hr>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<ul>
<li><a href="#part-I.-Protein-complexes-at-equilibrium"><code>Part I. Protein complexes at equilibrium</code></a>
<ul>
<li><a href="#protein-complex-preparation"><code>Protein complex preparation</code></a></li>
<li><a href="#protein-complex-without-a-structural-bias"><code>Protein complex without a structural bias</code></a>
<ul>
<li><a href="#step-1-generate-coarse-grained-topology"><code>Step 1. Generate coarse grained topology</code></a></li>
<li><a href="#step-2-set-up-the-simulation-box"><code>Step 2. Set up the simulation box</code></a></li>
<li><a href="#step-3-solvate-the-system"><code>Step 3. Solvate the system</code></a></li>
<li><a href="#step-4-add-ions"><code>Step 4. Add ions</code></a></li>
<li><a href="#step-5-energy-minimization"><code>Step 5. Energy minimization</code></a></li>
<li><a href="#step-6-equilibration-under-npt-conditions"><code>Step 6. Equilibration under NPT conditions</code></a></li>
<li><a href="#step-7-production-simulation"><code>Step 7. Production simulation</code></a></li>
</ul></li>
<li><a href="#protein-complex-with-elastic-network"><code>Protein complex with elastic network</code></a></li>
<li><a href="#protein-complex-with-OLIVES"><code>Protein complex with OLIVES</code></a></li>
<li><a href="#protein-complex-with-G≈çMartini3"><code>Protein complex with G≈çMartini 3</code></a></li>
<li><a href="#comparison-between-Martini-3-protein-complex-models"><code>Comparison between Martini 3 protein complex models</code></a></li>
</ul></li>
<li><a href="#part-ii-protein-complex-under-conformational-changes-a-nanomechanical-study"><code>Part II. Protein complex under conformational changes: A nanomechanical study</code></a>
<ul>
<li><a href="#AFM-SMFS-modelled-by-SMD"><code>AFM-SMFS modelled by SMD</code></a></li>
<li><a href="#SMD-with-G≈çMartini3"><code>SMD with G≈çMartini 3</code></a></li>
<li><a href="#SMD-with-optimized-G≈çMartini-3"><code>SMD with optimized G≈çMartini 3</code></a></li>
</ul></li>
<li><a href="#tools-and-scripts-used-in-this-tutorial"><code>Tools and scripts used in this tutorial</code></a></li>
<li><a href="#references"><code>References</code></a></li>
</ul>
</section>
<section id="part-i.-protein-complexes-at-equilibrium" class="level2">
<h2 class="anchored" data-anchor-id="part-i.-protein-complexes-at-equilibrium">Part I. Protein complexes at equilibrium</h2>
<hr>
<p>The global spread of SARS-CoV-2 has made clear the need to characterize spike protein dynamics and binding stability at scale. Understanding how mutations affect both overall fold and specific receptor or nanobody interfaces under near-physiological conditions is essential for predicting variant infectivity and guiding therapeutic design. In this tutorial, we‚Äôll implement and compare equilibrium coarse-grained (CG) strategies using the Martini 3 force field <sup><a href="#references">[1]</a></sup> to extend sampling to microsecond time scales without sacrificing key structural features. We then benchmark these approaches against full atomistic simulations to assess which approximation most faithfully reproduces protein flexibility at binding interfaces. We‚Äôll need a GROMACS version &gt;= 2023.5 <sup><a href="#references">[2]</a></sup>.</p>
<p>This section is not intended to capture large conformational changes. If you plan to to do so, please go to <a href="#part-II.-Protein-complexes-under-conformational-changes:-A-nanomechanical-study">Part II - Protein complex under conformational changes: A nanomechanical study</a></p>
</section>
<section id="protein-complex-preparation" class="level2">
<h2 class="anchored" data-anchor-id="protein-complex-preparation">Protein complex preparation</h2>
<hr>
<p>The structure with PDB ID 6ZH9 corresponds to a ternary complex composed of the receptor-binding domain (RBD) of the wild-type SARS-CoV-2 spike protein bound to the nanobody H11-H4 and the antibody CR3022. In this tutorial, we will focus specifically on the nanobody H11-H4, which engages the RBD at the receptor-binding interface and plays a critical role in neutralizing viral entry <sup><a href="#references">[12]</a></sup>. All worked and template files for this tutorial can be download from <a href="http://pomalab.ippt.pan.pl/web/complex1.zip">here</a>. If you want to skip the below preparation, the file ready to use, <code>6ZH9_clean.pdb</code>, is in the template folder.</p>
<ol type="1">
<li>Obtain the atomistic structure of the ternary complex from the Protein Data Bank <a href="https://www.rcsb.org/structure/6ZH9">here</a></li>
</ol>
<p>Alternatively, the file is available in the template folder</p>
<ol start="2" type="1">
<li>Before using <code>martinize2</code>, the atomistic structure must be cleaned and standardized:</li>
</ol>
<ul>
<li>Remove water molecules and crystallographic additives, as these are not needed for GG modeling.</li>
<li>Fix any missing residues or loops using your preferred modeling tool (e.g., AlphaFold2, Modeller, etc.).</li>
<li>Cofactors are not handled in this tutorial. If your system includes essential cofactors, they must be treated separately.</li>
</ul>
<ol start="3" type="1">
<li>Trim the system to the relevant components The structure contains multiple chains corresponding to antibodies and the RBD. For this tutorial, retain only the RBD and nanobody:</li>
</ol>
<ul>
<li>Delete chains HHH and LLL, which correspond to the antibody CR3022.</li>
<li>Rename the remaining chain IDs for clarity:</li>
<li>Change EEE to E ‚Üí RBD</li>
<li>Change FFF to F ‚Üí H11-H4 nanobody</li>
</ul>
<p>These modifications can be done using molecular visualization tools such as Chimera, ChimeraX, PyMOL, or VMD.</p>
</section>
<section id="protein-complex-without-a-structural-bias" class="level2">
<h2 class="anchored" data-anchor-id="protein-complex-without-a-structural-bias">Protein complex without a structural bias</h2>
<hr>
<p>In this section we will generate a CG model of the RBD/H114 complex using MARTINI 3.0.1 without tertiary structure bias. We will then:</p>
<p>Step 1. Generate the CG topology Step 2. Set up the simulation box Step 3. Solvate the system Step 4. Add ions Step 5. Perform energy minimization Step 6. Equilibrate under NPT conditions Step 7. Run the production simulation</p>
<section id="step-1.-generate-coarse-grained-topology" class="level3">
<h3 class="anchored" data-anchor-id="step-1.-generate-coarse-grained-topology">Step 1. Generate coarse-grained topology</h3>
<p>The cleaned PDB structure can now be used as input for martinize2 to generate both the CG structure and the corresponding Martini 3 topology file<sup><a href="#references">[3]</a></sup>. Installation instructions for martinize2 are available online. Please note that martinize2 may not be compatible with older versions of Python; it is known to work reliably with Python versions above 3.9. To explore the available options, refer to the help function by running <code>martinize2 -h</code>. A general recommendation for any system simulated with Martini is to apply position restraints, particularly on the backbone, during the equilibration phase. This allows the side chains to relax and adjust to solvent interactions without disrupting the overall fold. To support this, <code>martinize2</code> can automatically generate a list of atoms to be restrained. A typical command for running martinize2 might look like the following:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">martinize2</span> <span class="at">-f</span> 6ZH9_clean.pdb <span class="at">-o</span> topol.top <span class="at">-x</span> 6ZH9_CG.pdb <span class="at">-dssp</span> /path/to/dssp <span class="at">-p</span> backbone <span class="at">-ff</span> martini3001 <span class="at">-merge</span> all <span class="at">-ignh</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To run <code>martinize2</code>, we provide the input structure with the <code>-f</code> flag and specify two output files: a topology file using <code>-o</code> and a coordinate file for the structure mapped to Martini resolution using <code>-x</code>. The mapping will be done according to version 3 of the Martini force field, as indicated by the <code>-ff</code> flag.</p>
<p>To incorporate structural information into the CG model, we must also provide secondary structure data. Martinize2 offers several ways to supply this information:</p>
<ul>
<li><p>The -dssp option attempts to use the mdtraj Python module, which must be installed in the same environment as martinize2.</p></li>
<li><p>Alternatively, -dssp /path/to/dssp will invoke a DSSP binary at the specified path to extract secondary structure information directly from the structure. This binary can be downloaded from https://github.com/cmbi/dssp/releases. It is important to use version 3.1.4 or earlier, as later versions are not compatible due to output format changes. If DSSP is installed system-wide, the typical path is /usr/bin/mkdssp.</p></li>
</ul>
<p>A third option is to manually provide the secondary structure using the -ss flag followed by a DSSP-formatted string. This string must have the same number of characters as there are residues in the protein and should follow the DSSP notation:</p>
<p>H = Œ±-helix, B = residue in isolated Œ≤-bridge, E = extended strand (Œ≤-sheet), G = 3‚ÇÅ‚ÇÄ-helix, I = œÄ-helix, T = hydrogen-bonded turn, S = bend, C = coil or irregular.</p>
<p>If everything went correctly, martinize2 will have generated three essential files: the CG structure in PDB format (.pdb), the master topology file (topol.top), and the individual protein topology file (molecule_0.itp). To proceed with running a simulation, you will need two additional files: the Martini force field topology file (typically named martini_v3.0.0.itp) and a GROMACS run parameter file (.mdp). Example versions of these files can be found on the official Martini website or in the provided template folder. Make sure to adapt the parameter settings in the .mdp file and the topology as needed for your specific system.</p>
<p><img src="AA.png" title="Title" class="img-fluid" style="width:100.0%" alt="alt text"> Figure 1. Structural models of the RBD/H11-H4 complex. <strong>A)</strong> Atomistic model shown in cartoon representation. <strong>B)</strong> Corresponding CG model using the Martini framework. In both panels, the receptor-binding domain (RBD) is colored in blue and the nanobody H11-H4 in orange. All representations were prepared with ChimeraX<sup><a href="#references">[11]</a></sup>.</p>
<p>Once the CG model has been generated, it‚Äôs important to ensure that the topology file topol.top is correctly configured for a Martini 3 simulation. This file should include the appropriate force field definitions and reference the generated protein topology. A minimal working version of topol.top should look like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#include "martini_v3.0.0.itp"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#include "molecule_0.itp"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#include "martini_v3.0.0_ions_v1.itp"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#include "martini_v3.0.0_solvents_v1.itp"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> system <span class="bu">]</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="ex">SYSTEM</span> NAME</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> molecules <span class="bu">]</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="ex">molecule_0</span>    1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>After that, we need to modify the default force constant used for position restraints in the molecule_0.itp file. By default, <code>martinize2</code> may write a placeholder such as POSRES_FC, which must be replaced with an actual numerical value. In this case, we want to set the force constant to 1000 kJ mol‚Åª¬π nm‚Åª¬≤. This can be done using sed, a command-line tool for editing files in-place. Run the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">'s/POSRES_FC/1000/g'</span> molecule_0.itp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This command searches for all instances of POSRES_FC in the molecule_0.itp file and replaces them with 1000, ensuring that the position restraints are properly defined for use during equilibration or production runs.</p>
</section>
<section id="step-2.-set-up-the-simulation-box" class="level3">
<h3 class="anchored" data-anchor-id="step-2.-set-up-the-simulation-box">Step 2. Set up the simulation box</h3>
<p>To prepare the system for solvation and subsequent simulation, the first step is to center the CG complex in a simulation box. We use <code>gmx editconf</code> to place the structure in the center of a cubic box with 2.0 nm of padding between the solute and the box edges. This padding ensures that the solute does not interact with its periodic images. The command is as follows:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> editconf <span class="at">-f</span> 6ZH9_CG.pdb <span class="at">-bt</span> cubic <span class="at">-d</span> 2.0 <span class="at">-c</span> <span class="at">-o</span> 6ZH9_CG.gro</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Here:</p>
<ul>
<li><p>-f 6ZH9_CG.pdb specifies the input structure,</p></li>
<li><p>-bt cubic sets the box type to cubic,</p></li>
<li><p>-d 2.0 defines the distance (in nm) between the solute and the box boundary,</p></li>
<li><p>-c centers the molecule in the box,</p></li>
<li><p>-o 6ZH9_CG.gro defines the output file in GROMACS .gro format.</p></li>
</ul>
<p>Once the structure is centered and converted, we prepare the topology file. Make a copy of the previously edited topol.top file and rename it to system.top, which is the standard name expected in GROMACS workflows:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> topol.top system.top</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This ensures consistency in file naming and keeps the original topology intact for reference.</p>
</section>
<section id="step-3.-solvate-the-system" class="level3">
<h3 class="anchored" data-anchor-id="step-3.-solvate-the-system">Step 3. Solvate the system</h3>
<p>The next step is to solvate the simulation box using Martini water beads. This is done with the <code>gmx solvate</code> command, which fills the defined box with CG water molecules while avoiding overlap with the protein structure.</p>
<p>Use the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> solvate <span class="at">-cp</span> 6ZH9_CG.gro <span class="at">-cs</span> water.gro <span class="at">-radius</span> 0.21 <span class="at">-o</span> solvated.gro <span class="at">-p</span> system.top</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><p>-cp 6ZH9_CG.gro: specifies the centered and boxed protein structure as input.</p></li>
<li><p>-cs water.gro: provides the coordinate file containing Martini water beads (usually included in the Martini package).</p></li>
<li><p>-radius 0.21: sets the minimal distance (in nm) allowed between solute and solvent atoms, adapted for CG resolution.</p></li>
<li><p>-o solvated.gro: defines the output structure file with water molecules added.</p></li>
<li><p>-p system.top: automatically updates the topology file to include the number of added water molecules.</p></li>
</ul>
<p>This command prepares the system for ion addition and energy minimization by embedding the CG complex in a fully solvated environment.</p>
</section>
<section id="step-4.-add-ions" class="level3">
<h3 class="anchored" data-anchor-id="step-4.-add-ions">Step 4. Add ions</h3>
<p>To prepare the system for ion placement, we first need to generate a binary input file (.tpr) using the gmx grompp command. This step requires a minimal parameter file, typically named ions.mdp, which defines basic settings for preprocessing (e.g., cutoffs, integrator). Use the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> grompp <span class="at">-f</span> ions.mdp <span class="at">-c</span> solvated.gro <span class="at">-p</span> system.top <span class="at">-o</span> ions.tpr <span class="at">-maxwarn</span> 1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><p>-f ions.mdp specifies the parameter file.</p></li>
<li><p>-c solvated.gro is the input structure after solvation.</p></li>
<li><p>-p system.top is the updated topology.</p></li>
<li><p>-o ions.tpr is the binary run input file used by genion.</p></li>
<li><p>-maxwarn 1 allows grompp to proceed even if a minor warning is raised (e.g., due to missing velocities or box size mismatches).</p></li>
</ul>
<p>Once the .tpr file is ready, ions are added to neutralize the system and set the ionic strength to 0.15 M. The <code>gmx genion</code> command replaces solvent beads with sodium (NA) and chloride (CL) beads accordingly:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> W <span class="kw">|</span> <span class="ex">gmx</span> genion <span class="at">-s</span> ions.tpr <span class="at">-o</span> system_solv_ions.gro <span class="at">-p</span> system.top <span class="at">-pname</span> NA <span class="at">-nname</span> CL <span class="at">-neutral</span> <span class="at">-conc</span> 0.15</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><p>-s ions.tpr: input run file from grompp.</p></li>
<li><p>-o system_solv_ions.gro: output structure with ions added.</p></li>
<li><p>-p system.top: topology file, which is updated with the ion counts.</p></li>
<li><p>-pname NA and -nname CL: specify the names of the positive and negative ions.</p></li>
<li><p>-neutral: ensures overall charge neutrality.</p></li>
<li><p>-conc 0.15: sets the target salt concentration to 0.15 mol/L.</p></li>
</ul>
<p>This step finalizes the setup of the solvated and neutralized CG system, ready for energy minimization and equilibration.</p>
</section>
<section id="step-5.-energy-minimization" class="level3">
<h3 class="anchored" data-anchor-id="step-5.-energy-minimization">Step 5. Energy minimization</h3>
<p>The final preparation step before equilibration is to perform energy minimization of the solvated and ionized system. This ensures that any steric clashes or high-energy contacts introduced during solvation and ion addition are relaxed.</p>
<p>First, use <code>gmx grompp</code> to generate the minimization input file (.tpr) and then, launch the minimization run using gmx mdrun:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> grompp <span class="at">-p</span> system.top <span class="at">-c</span> system_solv_ions.gro <span class="at">-f</span> minimization.mdp <span class="at">-r</span> system_solv_ions.gro <span class="at">-o</span> minimization.tpr</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> mdrun <span class="at">-deffnm</span> minimization <span class="at">-v</span> <span class="at">-nt</span> 6 <span class="at">-pin</span> on <span class="at">-gpu_id</span> 0 <span class="at">-pinoffset</span> 0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><p>-deffnm minimization: sets the base name for input/output files (e.g., minimization.log, minimization.gro, etc.).</p></li>
<li><p>-v: enables verbose output.</p></li>
<li><p>-nt 6: runs with 6 CPU threads.</p></li>
<li><p>-pin on: enables CPU core pinning for performance consistency.</p></li>
<li><p>-gpu_id 0: selects GPU 0 (optional, only applicable if GROMACS was compiled with GPU support).</p></li>
<li><p>-pinoffset 0: ensures correct CPU affinity (optional; relevant for multi-GPU nodes).</p></li>
</ul>
</section>
<section id="step-6.-equilibration-under-npt-conditions" class="level3">
<h3 class="anchored" data-anchor-id="step-6.-equilibration-under-npt-conditions">Step 6. Equilibration under NPT conditions</h3>
<p>To stabilize the system‚Äôs density and pressure under near-physiological conditions, the next step is to perform NPT equilibration. This simulation phase is carried out in the constant number of particles, pressure, and temperature ensemble. The setup involves generating a new input .tpr file and running the equilibration with <code>gmx mdrun</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> grompp <span class="at">-p</span> system.top <span class="at">-c</span> minimization.gro <span class="at">-f</span> npt.mdp <span class="at">-r</span> minimization.gro <span class="at">-o</span> npt.tpr <span class="at">-maxwarn</span> 2</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> mdrun <span class="at">-deffnm</span> npt <span class="at">-v</span> <span class="at">-nt</span> 6 <span class="at">-pin</span> on <span class="at">-pinoffset</span> 0 <span class="at">-gpu_id</span> 0 <span class="at">-nb</span> gpu <span class="at">-bonded</span> gpu <span class="at">-dlb</span> auto</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="step-7.-production-simulation" class="level3">
<h3 class="anchored" data-anchor-id="step-7.-production-simulation">Step 7. Production simulation</h3>
<p>The final step is to launch the production simulation under fully equilibrated conditions. This is the stage where the system evolves freely and data are collected for analysis.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> grompp <span class="at">-p</span> system.top <span class="at">-c</span> npt.gro <span class="at">-f</span> dynamic.mdp <span class="at">-o</span> dynamic.tpr <span class="at">-maxwarn</span> 1  <span class="at">-t</span> npt.cpt</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> mdrun <span class="at">-deffnm</span> dynamic <span class="at">-v</span> <span class="at">-nt</span> 6 <span class="at">-pin</span> on <span class="at">-pinoffset</span> 0 <span class="at">-nb</span> gpu <span class="at">-bonded</span> gpu <span class="at">-dlb</span> auto</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="protein-complex-with-elastic-network" class="level2">
<h2 class="anchored" data-anchor-id="protein-complex-with-elastic-network">Protein complex with elastic network</h2>
<hr>
<p>In this step, we convert the atomistic structure of the protein complex into a coarse-grained representation using the Martini 3.0.0 force field, with the addition of an elastic network model (ENM). The elastic network is a set of harmonic springs applied between backbone beads within a defined cutoff range. It preserves the native tertiary and quaternary structure by maintaining the relative distances between residues, effectively stabilizing the folded conformation during the simulation. This is particularly important for large protein complexes, where thermal fluctuations can otherwise lead to partial unfolding or loss of structural integrity in CG models <sup><a href="#references">[14]</a></sup>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">martinize2</span> <span class="at">-f</span> 6ZH9_clean.pdb <span class="at">-o</span> topol.top <span class="at">-x</span> 6ZH9_CG.pdb <span class="at">-dssp</span> /path/to/dssp <span class="at">-p</span> backbone <span class="at">-ff</span> martini3001 <span class="at">-elastic</span> <span class="at">-ef</span> 700.0 <span class="at">-el</span> 0.5 <span class="at">-eu</span> 0.9 <span class="at">-ea</span> 0 <span class="at">-ep</span> 0 <span class="at">-merge</span> all <span class="at">-ignh</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Overwrite or modify the topology as stated above. Also modify the POSRES_FC place holder with the <code>sed</code> command previously stated.</p>
<p>Proceed with <a href="#step-2-set-up-the-simulation-box">steps 2 to 7</a> as described in the <em>Protein complex without a structure bias</em> section. These include box setup, solvation, ion addition, energy minimization, NPT equilibration, production run, trajectory alignment, and topology preparation for visualization.</p>
<p><img src="EN_crystal.gif" title="Title" class="img-fluid" alt="alt text"> Figure 2. Licorice representation of the RBD/H11-H4 backbone showing the elastic network model. Intra-chain harmonic restraints are depicted in black, and inter-chain restraints in green. Figure generated with ChimeraX <sup><a href="#references">[11]</a></sup>.</p>
</section>
<section id="protein-complex-with-olives" class="level2">
<h2 class="anchored" data-anchor-id="protein-complex-with-olives">Protein complex with OLIVES</h2>
<hr>
<p>To better preserve tertiary and quaternary structures in CG simulations, G≈ç-like models can be integrated with the Martini 3 force field, as introduced by Poma et al.&nbsp;(2017)<sup>[4]</sup>. In this step, we stabilize the structure of the CG protein complex using the OLIVES model, a G≈ç-like potential specifically designed to capture native hydrogen bonding patterns in Martini 3 proteins. Unlike traditional elastic networks or uniform G≈ç-models, OLIVES identifies native contacts capable of forming hydrogen bonds and introduces chemically informed Lennard-Jones interactions between donor‚Äìacceptor bead pairs. These interactions are separated into secondary (backbone‚Äìbackbone) and tertiary (side-chain‚Äìbackbone or side-chain‚Äìside-chain) networks, mimicking realistic intramolecular and interfacial hydrogen bonding <sup><a href="#references">[15]</a></sup>.</p>
<p>OLIVES improves structural fidelity by recovering missing hydrogen bond contributions in the CG representation and eliminates the need for DSSP-based secondary structure restraints. It also allows stabilizing both tertiary and quaternary structures without extensive biasing, thus enabling more realistic folding, unfolding, and complex formation events. This approach is particularly valuable for protein‚Äìprotein interfaces where standard CG models may underestimate stability without additional restraints .</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">martinize2</span> <span class="at">-f</span> 6ZH9_clean.pdb <span class="at">-o</span> topol.top <span class="at">-x</span> 6ZH9_CG.pdb <span class="at">-dssp</span> /path/to/dssp <span class="at">-p</span> backbone <span class="at">-ff</span> martini3001 <span class="at">-merge</span> all <span class="at">-ignh</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> OLIVES_v2.0.1_M3.0.0.py <span class="at">-c</span> 6ZH9_CG.pdb <span class="at">-i</span> molecule_0.itp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Continue with <a href="step-2-set-up-the-simulation-box">step 2</a>. Then, run the following:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> make_ndx <span class="at">-f</span> 6ZH9_CG.gro <span class="at">-o</span> BB.ndx <span class="op">&lt;&lt;&lt;</span> <span class="st">'del 0-19</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="st">a BB</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="st">q</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> genrestr <span class="at">-f</span> 6ZH9_CG.gro <span class="at">-n</span> BB.ndx <span class="at">-o</span> posre_BB.itp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Edit the topology as stated in <a href="#step-1-generate-coarse-grained-topology">step1</a>. Also modify the POSRES_FC with the command <code>sed</code> stated in the same step.</p>
<p>Create a copy of the topology</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> topol.top system.top</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Proceed with <a href="#step-3-solvate-the-system">steps 3 to 7</a> as described in the <em>Protein complex without a structure bias</em> section.</p>
<p><img src="OLIVES_crystal.gif" title="Title" class="img-fluid" alt="alt text"> Figure 3. Licorice representation of the RBD/H11-H4 backbone showing the OLIVES model. Intra-chain harmonic restraints are depicted in black, and inter-chain restraints in green. Figure generated with ChimeraX <sup><a href="#references">[11]</a></sup>.</p>
</section>
<section id="protein-complex-with-g≈çmartini-3" class="level2">
<h2 class="anchored" data-anchor-id="protein-complex-with-g≈çmartini-3">Protein complex with G≈çMartini 3</h2>
<hr>
<p>The enhanced G≈çMartini 3 implementation, described by Souza et al.&nbsp;(2025)<sup>[7]</sup>, improves on the original scheme with three key modifications:</p>
<ul>
<li><p>Virtual-site G≈ç beads: G≈ç interactions are applied to virtual sites co-located with backbone beads, treated as standard non-bonded pairs.</p></li>
<li><p>Exclusion of native non-bonded terms: Default Martini interactions between G≈ç-connected residues are excluded to avoid double-counting.</p></li>
<li><p>Distance bounds: Lower and upper cutoffs are applied to restrict G≈ç interactions within a defined range.</p></li>
</ul>
<p>These virtual interactions are encoded in martini_v3.0.0.itp, and activated when #define GO_VIRT is included in the system topology. This works similarly to how POSRES is handled.</p>
<p>The G≈ç contact map can be calculated using the web server available at <a href="http://pomalab.ippt.pan.pl/GoContactMap/">GoContactMap</a>. Alternatively, recent versions of martinize2 also support the generation of G≈ç contact maps directly.</p>
<p>Upon using the <code>-go</code> flag, <code>martinize2</code> will:</p>
<ul>
<li>Read or generate the contact map</li>
<li>Add G≈ç virtual beads</li>
<li>Define G≈ç contact interactions</li>
<li>Exclude native non-bonded terms</li>
</ul>
<p>This makes it possible to generate a fully functional G≈çMartini model from a cleaned PDB structure with a single command, such as:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">martinize2</span> <span class="at">-f</span> 6ZH9_clean.pdb <span class="at">-o</span> topol.top <span class="at">-x</span> 6ZH9_CG.pdb <span class="at">-dssp</span> /route/to/dssp <span class="at">-p</span> backbone <span class="at">-ff</span> martini3001 <span class="at">-go-eps</span> 15.00 <span class="at">-go</span> <span class="at">-maxwarn</span> 4 <span class="at">-merge</span> all <span class="at">-ignh</span> <span class="at">-name</span> molecule_0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The command shown above generates all required topology and structure files for performing G≈çMartini simulations of the protein using martinize2. This includes virtual G≈ç beads, native contact-based interactions, and the appropriate exclusions of default non-bonded terms between backbone beads connected by G≈ç-like bonds.</p>
<p>As mentioned earlier, the protein topology file (molecule0.itp) generated by martinize2 now includes additional virtual sites placed directly on top of the backbone beads. These virtual sites serve as anchoring points for the G≈ç-like interactions and are referenced in two auxiliary files:</p>
<ul>
<li><p>go_atomtypes.itp: contains an [ atomtypes ] directive that defines the properties of the virtual G≈ç beads.</p></li>
<li><p>go_nbparams.itp: contains a [ nonbond_params ] directive that defines the G≈ç-like interactions between pairs of virtual sites, according to the native contact map.</p></li>
</ul>
<p>To enable these additional non-bonded interactions during the simulation, you must insert the appropriate #include statements into the martini_v3.0.0.itp force field file. This ensures that the simulation engine recognizes the virtual G≈ç atom types and their interaction parameters.</p>
<p>Note: If you are using the .itp files provided in the template folder, you do not need to manually add the #include statements for the G≈çMartini 3 model. These modifications have already been applied to the martini_v3.0.0.itp file included in that folder.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">"s/\[ nonbond_params \]/\#ifdef GO_VIRT\n\#include </span><span class="dt">\"</span><span class="st">go_atomtypes.itp</span><span class="dt">\"</span><span class="st">\n\#endif\n\n\[ nonbond_params \]/"</span> martini_v3.0.0.itp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">"\n#ifdef GO_VIRT \n#include </span><span class="dt">\"</span><span class="st">go_nbparams.itp</span><span class="dt">\"</span><span class="st">\n#endif"</span> <span class="op">&gt;&gt;</span> martini_v3.0.0.itp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Important: These modifications to martini_v3.0.0.itp should be done only once, regardless of how many proteins or simulations use G≈ç-like interactions. Repeating the inclusion or duplicating entries may lead to errors or unintended behavior during preprocessing.</p>
<p>The topol.top file must be updated to activate the G≈çMartini features by defining the GO_VIRT preprocessor variable. This ensures that the virtual sites and G≈ç-specific interaction parameters are included during simulation setup. The file should look as follows:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define GO_VIRT</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#include "martini_v3.0.0.itp"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#include "molecule_0.itp"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#include "martini_v3.0.0_ions_v1.itp"</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#include "martini_v3.0.0_solvents_v1.itp"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> system <span class="bu">]</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="ex">SYSTEM</span> NAME</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> molecules <span class="bu">]</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="ex">molecule_0</span>    1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This will ensure that the virtual site definitions and G≈ç-like nonbonded interactions are properly included in the simulation.</p>
<p>Proceed with <a href="#step-2-setup-the-simulation-box">steps 2 to 7</a> as described in the <em>Protein complex without a structural bias</em> section.</p>
<p><img src="Go_crystal.gif" title="Title" class="img-fluid" alt="alt text"> Figure 4. Licorice representation of the RBD/H11-H4 backbone illustrating the G≈çMartini 3 model. Intra-chain native contacts are shown in black, while inter-chain contacts are shown in green. Figure generated with ChimeraX<sup><a href="#references">[11]</a></sup>.</p>
</section>
<section id="comparison-between-martini-3-protein-complex-models" class="level2">
<h2 class="anchored" data-anchor-id="comparison-between-martini-3-protein-complex-models">Comparison between Martini 3 protein complex models</h2>
<hr>
<p>Table 1. Number of native contacts defined in each coarse-grained model. The table summarizes the number of native contacts determined to the RBD‚Äìnanobody interface, as well as intra-domain contacts within the RBD and within the nanobody, for three coarse-grained models: Elastic Network, OLIVES, and G≈çMartini 3.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Model</th>
<th style="text-align: center;"># interface contacts</th>
<th style="text-align: center;"># intra contacts RBD</th>
<th style="text-align: center;"># intra contacts Nb</th>
<th style="text-align: center;">Total contacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">EN</td>
<td style="text-align: center;">53</td>
<td style="text-align: center;">837</td>
<td style="text-align: center;">553</td>
<td style="text-align: center;">1443</td>
</tr>
<tr class="even">
<td style="text-align: center;">OLIVES</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">246</td>
<td style="text-align: center;">169</td>
<td style="text-align: center;">427</td>
</tr>
<tr class="odd">
<td style="text-align: center;">G≈çMartini&nbsp;3</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">393</td>
<td style="text-align: center;">283</td>
<td style="text-align: center;">702</td>
</tr>
</tbody>
</table>
<p><img src="comparison.png" title="Title" class="img-fluid" alt="alt text"> Figure 5. Structural stability and residue-level fluctuations across modeling approaches. <strong>A)</strong> Root-mean-square deviation (RMSD) of the protein backbone over a 1 Œºs simulation comparing all-atom (AA), elastic network (EN), OLIVES, and G≈çMartini 3 models. The inset shows the same data with a different y-axis scale to highlight differences among CG models. The AA trajectory exhibits greater structural deviation compared to the CG models, which remain stable throughout the simulation. <strong>B)</strong> Root-mean-square fluctuation (RMSF) per residue. Residues 449‚Äì494 correspond to the RBD, and residues 100‚Äì106 to H11-H4, separated by a dashed line.</p>
</section>
<section id="part-ii.-protein-complex-under-conformational-changes-a-nanomechanical-study" class="level2">
<h2 class="anchored" data-anchor-id="part-ii.-protein-complex-under-conformational-changes-a-nanomechanical-study">Part II. Protein complex under conformational changes: A nanomechanical study</h2>
<hr>
</section>
<section id="afm-smfs-captured-by-steered-molecular-dynamics-smd-simulation" class="level2">
<h2 class="anchored" data-anchor-id="afm-smfs-captured-by-steered-molecular-dynamics-smd-simulation">AFM-SMFS captured by Steered Molecular Dynamics (SMD) simulation</h2>
<hr>
<p>Nanomechanical characterisation probes how protein complexes respond to externally applied forces and uncovers dissociation pathways and energy barriers. By using SMD simulation within the Martini 3 CG framework augmented by G≈çMartini 3 virtual-site contacts<sup><a href="#references">[7]</a></sup>, we attach defined pulling anchors to key residues and generate force-extension profiles at biologically relevant pulling speeds. This approach captures critical rupture events and force propagation pathways across the RBD and an engineered nanobody, highlighting the influence of variant mutations on mechanical stability <sup><a href="#references">[2]</a></sup>. CG-SMD simulation bridges the gap between high-cost AA-MD simulations and experimental single molecular force spectroscopy (SMFS) <sup><a href="#references">[9,10]</a></sup>.</p>
<section id="protein-alignment-along-the-z-axis" class="level3">
<h3 class="anchored" data-anchor-id="protein-alignment-along-the-z-axis">Protein alignment along the Z-axis</h3>
<p>The complex can be prepared as described in section <a href="#protein-complex-preparation">Protein preparation</a>. All worked and template files for this tutorial can be download from <a href="http://pomalab.ippt.pan.pl/web/complex2.zip">here</a>. If you want to skip the preparation step, the file ready to use, <code>6ZH9_clean.pdb</code>, is in the template folder.</p>
<p>We‚Äôll use‚ÄØ<code>align_pdb.py</code>‚ÄØscript to bring the pulling axis onto the z‚Äëaxis, and then we will add missing atoms and hydrogens with pdbfixer.</p>
<p>First, make sure you have <code>python‚ÄØ3</code>, <code>numpy</code>, <code>biopython</code> installed. In your terminal run:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> align_pdb.py <span class="op">&lt;</span>input_pdb<span class="op">&gt;</span> <span class="op">&lt;</span>output_pdb<span class="op">&gt;</span> <span class="op">&lt;</span>chain1<span class="op">&gt;</span> <span class="op">&lt;</span>res1<span class="op">&gt;</span> <span class="op">&lt;</span>chain2<span class="op">&gt;</span> <span class="op">&lt;</span>res2<span class="op">&gt;</span> --axis</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> align_pdb_.py 6ZH9_clean.pdb 6ZH9_aligned.pdb E 195 F 128 <span class="at">--axis</span> Z</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This reads‚ÄØ6ZH9_clean.pdb, locates the two CA atoms you specified, computes the rotation that brings their connecting line onto the Z‚Äëaxis, applies that transform to every atom, and writes the result to‚ÄØ6ZH9_aligned.pdb.</p>
<p>To generate the Martini 3/GoMartini 3 model, please follow the instructions in the <a href="#protein-complex-with-G≈çMartini3">Protein complex with G≈çMartini 3</a> section using the <code>6ZH9_aligned.pdb</code> file. From <code>martinize2</code> you‚Äôll get the new <code>6ZH9_CG.pdb</code> file.</p>
</section>
<section id="step-2.-set-up-the-simulation-with-a-large-box" class="level3">
<h3 class="anchored" data-anchor-id="step-2.-set-up-the-simulation-with-a-large-box">Step 2. Set up the simulation with a large box</h3>
<p>Prepare the system for solvation and subsequent simulation with the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> editconf <span class="at">-f</span> 6ZH9_CG.pdb <span class="at">-center</span> 5.000 5.000 6.000 <span class="at">-box</span> 10.000 10.000 60.000 <span class="at">-o</span> 6ZH9_WT_pull_CG.gro</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Copy the topology and rename it as system.top</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> topol.top system.top</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Proceed with <a href="#3-solvate-the-system">steps 3 to 6</a> as described in the <em>Protein complex without a structural bias</em> section.</p>
<p>After step 6, we need to create an index file to apply the freeze protocol and to perform the CG-SDM:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> make_ndx <span class="at">-f</span> npt.gro <span class="at">-o</span> index.ndx</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="ex">a</span> 786 787 788 789 790 791</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="ex">name</span> 15 Pull_A</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="ex">a</span> 471 472 473 474 475 476</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="ex">name</span> 16 Pull_B</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="ex">q</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="run-the-production-simulation" class="level3">
<h3 class="anchored" data-anchor-id="run-the-production-simulation">7. Run the production simulation</h3>
<p>The final step is to launch the production simulation under fully equilibrated conditions.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> grompp <span class="at">-p</span> system.top <span class="at">-c</span> npt.gro <span class="at">-f</span> pull.mdp <span class="at">-o</span> pull1.tpr <span class="at">-maxwarn</span> 1  <span class="at">-t</span> npt.cpt <span class="at">-r</span> npt.gro</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="ex">gmx</span> mdrun <span class="at">-deffnm</span> pull1 <span class="at">-v</span> <span class="at">-nt</span> 6 <span class="at">-pin</span> on <span class="at">-pinoffset</span> 0 <span class="at">-nb</span> gpu <span class="at">-bonded</span> gpu <span class="at">-dlb</span> auto <span class="at">-pf</span> pullf1.xvg <span class="at">-px</span> pullx1.xvg</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="Fd.png" title="Title" class="img-fluid" alt="alt text"> Figure 6. Force‚Äìdisplacement profiles from CG-SMD simulations and AA-SMD reference. A) Mechanical unfolding profiles obtained using the native contacts. Each light gray line corresponds to an individual CG-SMD trajectory, and the green line represents the average. Inset: distribution of maximum rupture forces (F<sub>max</sub>) with fitted Gaussian (red). B) Same as panel A, but using high-frequency contacts. (C) Reference rupture force profile obtained from AA-SMD simulations, redrawn from <sup><a href="#references">[13]</a></sup>. The pulling velocity was 10<sup>-3</sup> nm/ps for all cases.</p>
<p>Based on AA-SMD simulations from G√∂lc√ºk et al.&nbsp;<sup>[13]</sup>, partial unfolding is not expected during unbinding. However, when native contacts are used to define the interface, they appear to overstabilize the complex, leading to an artificial partial unfolding of the H11‚ÄìH4 region. Moreover, the resulting rupture forces are higher than those reported in the original AA-SMD data. To more accurately reproduce the rupture behavior of the complex, it is therefore necessary to rely on high-frequency contacts, which better reflect the dynamic stability observed in atomistic simulations.</p>
</section>
</section>
<section id="protein-complex-with-optimized-g≈çmartini-3" class="level2">
<h2 class="anchored" data-anchor-id="protein-complex-with-optimized-g≈çmartini-3">Protein complex with optimized G≈çMartini 3</h2>
<hr>
<p>To better capture the nanomechanical behavior of this complex, we can use the AA-MD simulation used in Part I. This simulation will allow to determine the most persistent protein contacts, as described in <sup><a href="#references">[8]</a></sup>. The AA-MD trajectory is located in the All-atom directory. We will use <code>traj_to_pdb.py</code> and <code>contact_calculation.py</code> (located in the template folder) to convert the trajectory to pdb format and to calculate high-frequency contacts as follows:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> traj_to_pdb.py  <span class="at">--trajectory</span> 6ZH9_WT_dry_100.nc <span class="at">--topology</span> 6ZH9_WT_dry.parm7  <span class="at">--ranges</span> 1-195,195-323 <span class="at">--outdir</span> . <span class="at">--stride</span> 1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><p>‚Äìtrajectory specifies the trajectory file (e.g., .xtc, .dcd, .nc). In this case, the file 6ZH9_WT_dry.nc is located in the 6ZH9_AA folder, with each frame representing 1 ns.</p></li>
<li><p>‚Äìtopology refers to the coordinate file (e.g., .pdb, .gro, parm7)</p></li>
<li><p>‚Äìranges defines the residue blocks corresponding to each chain (e.g., A: 2-196, B: 197-325)</p></li>
</ul>
<p>The <code>contact_calculation.py</code> script automates the analysis of PDB trajectory frames to generate a CG topology with filtered high-frequency contacts. Then, it identifies the frame with the most high-frequency contacts to serve as input for CG. After that, it runs <code>martinize2</code> with <code>-go</code> bias on the selected reference frame.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> contact_calculation.py <span class="at">--short</span> 3.0 <span class="at">--long</span> 11.0 <span class="at">--cm</span> /path/to/contact_map <span class="at">--type</span> inter <span class="at">--cpus</span> 15 <span class="at">--threshold</span> 0.7 <span class="at">--merge</span> all <span class="at">--dssp</span> /usr/bin/mkdssp <span class="at">--go-eps</span> 15.0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>‚Äìshort and ‚Äìlong define the minimum and maximum distance cutoffs for contact detection (in √Ö).</li>
<li>‚Äìcm points to the directory containing the contact_map executable. Available here <a href="https://zenodo.org/records/3817447">here</a> or <a href="https://github.com/Martini-Force-Field-Initiative/GoMartini/tree/main/ContactMapGenerator">here</a></li>
<li>‚Äìtype sets the analysis scope (<code>both</code>, <code>intra</code>, or <code>inter</code>).</li>
<li>‚Äìcpus defines the number of parallel workers for contact computation.</li>
<li>‚Äìthreshold is the minimum frequency to classify a contact as high-frequency (0.7 is recommended).</li>
<li>‚Äìmerge lists the chains to merge prior to running martinize2.</li>
<li>‚Äìdssp provides the path to the DSSP executable (e.g., /usr/bin/mkdssp).</li>
<li>‚Äìgo-eps sets the epsilon value (in kJ/mol) for the G≈ç-model potential (a default value of 12.0 or 15.0 is suggested).</li>
<li>‚Äìfrom indicates the origin of the topology (amber or charmm).</li>
</ul>
<p>In this case, the file with the most contacts was frame_0095. Then, we need to align it to the Z-axis using the <code>align_pdb.py</code> script:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> align_pdb.py frame_0095_CG.pdb frame_0095_CG_aligned.pdb A 195 B 323 <span class="at">--axis</span> Z</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Procees with Step 2. Set up the simulation with a large box as described above. Then proceed with <a href="#3-solvate-the-system">steps 3 to 6</a> as described in the <em>Protein complex without a structural bias</em> section. After that, run step 7 as stated above.</p>
<p><img src="SMD.gif" title="Title" class="img-fluid" alt="alt text"> Figure 7. Licorice representation of the RBD/H11-H4 complex during pulling under constant velocity. Figure generated with ChimeraX <sup><a href="#references">[11]</a></sup>.</p>
</section>
<section id="tools-and-scripts-used-in-this-tutorial" class="level2">
<h2 class="anchored" data-anchor-id="tools-and-scripts-used-in-this-tutorial">Tools and scripts used in this tutorial</h2>
<hr>
<ul>
<li><code>GROMACS</code> (<a href="http://www.gromacs.org/" class="uri">http://www.gromacs.org/</a>)</li>
<li><code>Martinize2</code> (<a href="https://github.com/marrink-lab/vermouth-martinize" class="uri">https://github.com/marrink-lab/vermouth-martinize</a>)</li>
<li><code>Contact map executable file</code> <a href="https://zenodo.org/records/3817447">link 1</a> or <a href="https://github.com/Martini-Force-Field-Initiative/GoMartini/tree/main/ContactMapGenerator">link 2</a></li>
<li><code>traj_to_pdb.py and contact_calculation.py scripts</code> <a href="https://github.com/GoMartini3-tools/ContactFreq">here</a></li>
</ul>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<hr>
<ol type="1">
<li>Souza, P. C. T., Alessandri, R., Barnoud, J., Thallmair, S., Faustino, I., Gr√ºnewald, F., ‚Ä¶ &amp; Marrink,. J. (2021). Martini 3: a general purpose force field for coarse-grained molecular dynamics. Nature Methods, 18(4), 382-388. https://doi.org/10.1038/s41592-021-01098-3</li>
<li>Abraham, M., Murtola, T. J., Schulz, R., P√°ll, S., Smith, J. C., Hess, B., ‚Ä¶ &amp; Lindahl, E. (2015). Gromacs: high performance molecular simulations through multi-level parallelism from laptops to supercomputers. SoftwareX, 1-2, 19-25. https://doi.org/10.1016/j.softx.2015.06.001</li>
<li>Kroon, P. C., Grunewald, F., Barnoud, J., van Tilburg, M., Brasnett, C., de Souza, P. C. T., ‚Ä¶ &amp; Marrink, S. J. (2025). Martinize2 and vermouth: unified framework for topology generation.. https://doi.org/10.7554/elife.90627.3</li>
<li>Poma, A. B., Cieplak, M., &amp; Theodorakis, P. E. (2017). Combining the martini and structure-based coarse-grained approaches for the molecular dynamics studies of conformational transitions in proteins. Journal of Chemical Theory and Computation, 13(3), 1366-1374. https://doi.org/10.1021/acs.jctc.6b00986</li>
<li>Moreira, R. A., Guzman, H. V., Boopathi, S., Baker, J. L., &amp; Poma, A. B. (2020). Characterization of structural and energetic differences between conformations of the sars-cov-2 spike protein. Materials, 13(23), 5362. https://doi.org/10.3390/ma13235362</li>
<li>Cofas‚ÄêVargas, L. F., Moreira, R. d.&nbsp;A., Poblete, S., Chwastyk, M., &amp; Poma, A. B. (2024). The G≈çmartini approach: revisiting the concept of contact maps and the modelling of protein complexes. Acta Physica Polonica A, 145(3), S9-S20. https://doi.org/10.12693/aphyspola.145.s9</li>
<li>Souza, P. C. T., Borges-Ara√∫jo, L., Brasnett, C., Moreira, R. A., Gr√ºnewald, F., Park, P., ‚Ä¶ &amp; Thallmair, S. (2025). G≈çmartini 3: from large conformational changes in proteins to environmental bias corrections. Nature Communications, 16(1). https://doi.org/10.1038/s41467-025-58719-0</li>
<li>Cofas‚ÄêVargas, L. F., Olivos-Ram√≠rez, G. E., Chwastyk, M., Moreira, R. A., Baker, J. L., Marrink, . J., ‚Ä¶ &amp; Poma, A. B. (2024). Nanomechanical footprint of sars-cov-2 variants in complex with a potent nanobody by molecular simulations. Nanoscale, 16(40), 18824-18834. https://doi.org/10.1039/d4nr02074j</li>
<li>Liu, Z., Moreira, R. A., Dujmoviƒá, A., Liu, H., Yang, B., Poma, A. B., ‚Ä¶ &amp; Nash, M. A. (2021). Mapping mechanostable pulling geometries of a therapeutic anticalin/ctla-4 protein complex. Nano Letters, 22(1), 179-187. https://doi.org/10.1021/acs.nanolett.1c03584</li>
<li>Koehler, M., Ray, A., Moreira, R. A., Juniku, B., Poma, A. B., &amp; Alsteens, D. (2021). Molecular insights into receptor binding energetics and neutralization of sars-cov-2 variants. Nature Communications, 12(1). https://doi.org/10.1038/s41467-021-27325-1</li>
<li>Meng, E. C., Goddard, T. D., Pettersen, E. F., Couch, G. S., Pearson, Z., Morris, J. H., ‚Ä¶ &amp; Ferrin, T. E. (2023). ucsf chimerax: tools for structure building and analysis. Protein Science, 32(11). https://doi.org/10.1002/pro.4792</li>
<li>Huo, J., Bas, A. L., Ruza, R. R., Duyvesteyn, H. M. E., Mikolajek, H., Malinauskas, T., ‚Ä¶ &amp; Naismith, J. H. (2020). Neutralizing nanobodies bind sars-cov-2 spike rbd and block interaction with ace2. Nature Structural &amp;Amp; Molecular Biology, 27(9), 846-854. https://doi.org/10.1038/s41594-020-0469-6</li>
<li>G√∂lc√ºk, M., Hacisuleyman, A., Yilmaz, S. Z., Taka, E., Yƒ±ldƒ±z, A., &amp; G√ºr, M. (2022). Sars-cov-2 delta variant decreases nanobody binding and ace2 blocking effectivity. Journal of Chemical Information and Modeling, 62(10), 2490-2498. https://doi.org/10.1021/acs.jcim.1c01523</li>
<li>P√©riole, X., Cavalli, M., Marrink, &amp;. J., &amp; Ceruso, M. (2009). Combining an elastic network with a coarse-grained molecular force field: structure, dynamics, and intermolecular recognition. Journal of Chemical Theory and Computation, 5(9), 2531-2543. https://doi.org/10.1021/ct9002114</li>
<li>Pedersen, K. B., Borges-Ara√∫jo, L., Stange, A. D., Souza, P. C. T., Marrink, J., &amp; Schi√∏tt, B. (2024). Olives: a goÃÖ-like model for stabilizing protein structure via hydrogen bonding native contacts in the martini 3 coarse-grained force field. Journal of Chemical Theory and Computation. https://doi.org/10.1021/acs.jctc.4c00553</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/cgmartini\.nl");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<div class="footer-left">

</div>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/cg_martini">
      <i class="bi bi-twitter" role="img" aria-label="Martini Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../docs/faq/index.html">
<p><iconify-icon inline="true" role="img" icon="hugeicons:help-circle" style="font-size: 1.25em;" aria-label="FAQs" title="FAQs"></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Martini-Force-Field-Initiative">
      <i class="bi bi-github" role="img" aria-label="Martini GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
<div class="footer-right">
¬© 2025 Martini Force Field Initiative <img src="https://cgmartini-library.s3.ca-central-1.amazonaws.com/icon.png" alt="Icon">
</div>
</div>
  </div>
</footer>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const quotes = [
          "<i>Shaken, not stirred.</i> - James Bond",
          "<i>He was white and shaken, like a dry martini.</i> - P. G. Wodehouse",      
          "<i>I think people think we're all sipping martinis by the pool.</i> - Maria Menounos",
          "<i>Why don't you get out of that wet coat and into a dry martini?</i> - Robert Benchley",
          "<i>Really, can anyone drink several martinis at lunch?</i> - Christine Baranski",
          "<i>Zen martini: A martini with no vermouth at all. And no gin, either.</i> - P.J. O'Rourke",
          "<i>I never go jogging, it makes me spill my martini.</i> - George Burns",
          "<i>Martinis are the only American invention as perfect as a sonnet.</i> - H. L. Mencken",
          "<i>He knows just how I like my martini: full of alcohol.</i> - Homer Simpson",
          "<i>Happiness is: finding olives in your martini when you're hungry.</i> - Johnny Carson",
          "<i>If it wasn't for the olives in his martinis he'd starve to death.</i> - Milton Berle",
        ];
      const randomIndex = Math.floor(Math.random() * quotes.length);
      const randomQuote = quotes[randomIndex];

      const footerLeft = document.querySelector('.footer-left');
      if (footerLeft) {
          footerLeft.innerHTML = randomQuote;
      }
    });
</script>
<script src="../../../../js/sidebar-close.js"></script> 




</body></html>