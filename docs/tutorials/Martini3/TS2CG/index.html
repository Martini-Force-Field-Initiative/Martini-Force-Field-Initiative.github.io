<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TS2CG 2.0 as a membrane builder – Martini Force Field Initiative</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../images/favicon.png" rel="icon" type="image/png">
<script src="../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-094f87d8d1cb9068919611e167c728e2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../../../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const quotes = [
          "<i>Shaken, not stirred.</i> - James Bond",
          "<i>He was white and shaken, like a dry martini.</i> - P. G. Wodehouse",      
          "<i>I think people think we're all sipping martinis by the pool.</i> - Maria Menounos",
          "<i>Why don't you get out of that wet coat and into a dry martini?</i> - Robert Benchley",
          "<i>Really, can anyone drink several martinis at lunch?</i> - Christine Baranski",
          "<i>Zen martini: A martini with no vermouth at all. And no gin, either.</i> - P.J. O'Rourke",
          "<i>I never go jogging, it makes me spill my martini.</i> - George Burns",
          "<i>Martinis are the only American invention as perfect as a sonnet.</i> - H. L. Mencken",
          "<i>He knows just how I like my martini: full of alcohol.</i> - Homer Simpson",
          "<i>Happiness is: finding olives in your martini when you're hungry.</i> - Johnny Carson",
          "<i>If it wasn't for the olives in his martinis he'd starve to death.</i> - Milton Berle",
        ];
      const randomIndex = Math.floor(Math.random() * quotes.length);
      const randomQuote = quotes[randomIndex];

      const footerLeft = document.querySelector('.footer-left');
      if (footerLeft) {
          footerLeft.innerHTML = randomQuote;
      }
    });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../styles.css">
<meta property="og:title" content="TS2CG 2.0 as a membrane builder – Martini Force Field Initiative">
<meta property="og:description" content="">
<meta property="og:image" content="https://cgmartini.nl/docs/tutorials/Martini3/TS2CG/image_0.png">
<meta property="og:site_name" content="Martini Force Field Initiative">
<meta property="og:image:height" content="1735">
<meta property="og:image:width" content="3000">
<meta name="twitter:title" content="TS2CG 2.0 as a membrane builder – Martini Force Field Initiative">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://cgmartini.nl/docs/tutorials/Martini3/TS2CG/image_0.png">
<meta name="twitter:image-height" content="1735">
<meta name="twitter:image-width" content="3000">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../images/martini.gif" alt="martini logo" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../index.html"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../../docs/tutorials/index.html" aria-current="page"> <i class="bi bi-mortarboard-fill" role="img">
</i> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/downloads/index.html"> <i class="bi bi-download" role="img">
</i> 
<span class="menu-text">Downloads</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/publications/index.html"> <i class="bi bi-newspaper" role="img">
</i> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/announcements/index.html"> 
<span class="menu-text"><i class="fa-solid fa-bullhorn" aria-label="bullhorn"></i> Announcements</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/contact/index.html"> 
<span class="menu-text"><i class="fa-regular fa-address-book" aria-label="address-book"></i> Contact</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-fa-circle-info--help" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i> Help</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-fa-circle-info--help">    
        <li>
    <a class="dropdown-item" href="https://github.com/orgs/Martini-Force-Field-Initiative/discussions"><i class="bi bi-chat-right-text" role="img">
</i> 
 <span class="dropdown-text">Discussion Board</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/orgs/Martini-Force-Field-Initiative/discussions"><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">Report an Issue</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../docs/faq/index.html"><i class="bi bi-question-circle" role="img">
</i> 
 <span class="dropdown-text">FAQs</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/cg_martini" title="Martini Twitter" class="quarto-navigation-tool px-1" aria-label="Martini Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/Martini-Force-Field-Initiative" title="Martini GitHub" class="quarto-navigation-tool px-1" aria-label="Martini GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">TS2CG 2.0 as a membrane builder</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b>Summary</b></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">🎓 Martini Lectures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Martini3/tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">🛠️ Hands-on Tutorials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../docs/tutorials/Legacy/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">🕸️ Legacy Material</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#table-of-contents" id="toc-table-of-contents" class="nav-link active" data-scroll-target="#table-of-contents">Table of Contents</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#the-ts2cg-workflow" id="toc-the-ts2cg-workflow" class="nav-link" data-scroll-target="#the-ts2cg-workflow">The TS2CG Workflow</a></li>
  </ul></li>
  <li><a href="#installation-and-setup" id="toc-installation-and-setup" class="nav-link" data-scroll-target="#installation-and-setup">Installation and Setup</a>
  <ul class="collapse">
  <li><a href="#installing-ts2cg" id="toc-installing-ts2cg" class="nav-link" data-scroll-target="#installing-ts2cg">Installing TS2CG</a></li>
  <li><a href="#download-tutorial-files" id="toc-download-tutorial-files" class="nav-link" data-scroll-target="#download-tutorial-files">Download Tutorial Files</a></li>
  <li><a href="#additional-requirements" id="toc-additional-requirements" class="nav-link" data-scroll-target="#additional-requirements">Additional Requirements</a></li>
  </ul></li>
  <li><a href="#chapter-1-basic-vesicle" id="toc-chapter-1-basic-vesicle" class="nav-link" data-scroll-target="#chapter-1-basic-vesicle">Chapter 1: Basic Vesicle</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#generate-point-folder-with-plm" id="toc-generate-point-folder-with-plm" class="nav-link" data-scroll-target="#generate-point-folder-with-plm">Generate Point Folder with PLM</a></li>
  <li><a href="#create-lipid-composition-file" id="toc-create-lipid-composition-file" class="nav-link" data-scroll-target="#create-lipid-composition-file">Create Lipid Composition File</a></li>
  <li><a href="#build-the-membrane-using-pcg" id="toc-build-the-membrane-using-pcg" class="nav-link" data-scroll-target="#build-the-membrane-using-pcg">Build the Membrane using PCG</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  </ul></li>
  <li><a href="#chapter-2-lipid-mixtures" id="toc-chapter-2-lipid-mixtures" class="nav-link" data-scroll-target="#chapter-2-lipid-mixtures">Chapter 2: Lipid Mixtures</a>
  <ul class="collapse">
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1">Overview</a></li>
  <li><a href="#create-mixed-composition" id="toc-create-mixed-composition" class="nav-link" data-scroll-target="#create-mixed-composition">Create Mixed Composition</a></li>
  <li><a href="#build-the-membrane-using-pcg-1" id="toc-build-the-membrane-using-pcg-1" class="nav-link" data-scroll-target="#build-the-membrane-using-pcg-1">Build the Membrane using PCG</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1">Visualization</a></li>
  </ul></li>
  <li><a href="#chapter-3-membrane-proteins" id="toc-chapter-3-membrane-proteins" class="nav-link" data-scroll-target="#chapter-3-membrane-proteins">Chapter 3: Membrane Proteins</a>
  <ul class="collapse">
  <li><a href="#overview-2" id="toc-overview-2" class="nav-link" data-scroll-target="#overview-2">Overview</a></li>
  <li><a href="#adding-a-protein-to-the-membrane" id="toc-adding-a-protein-to-the-membrane" class="nav-link" data-scroll-target="#adding-a-protein-to-the-membrane">Adding a Protein to the Membrane</a></li>
  <li><a href="#place-proteins-using-inu" id="toc-place-proteins-using-inu" class="nav-link" data-scroll-target="#place-proteins-using-inu">Place Proteins using INU</a></li>
  <li><a href="#build-the-membrane-using-pcg-2" id="toc-build-the-membrane-using-pcg-2" class="nav-link" data-scroll-target="#build-the-membrane-using-pcg-2">Build the Membrane using PCG</a></li>
  <li><a href="#visualization-2" id="toc-visualization-2" class="nav-link" data-scroll-target="#visualization-2">Visualization</a></li>
  </ul></li>
  <li><a href="#chapter-4-lipid-domains-around-proteins" id="toc-chapter-4-lipid-domains-around-proteins" class="nav-link" data-scroll-target="#chapter-4-lipid-domains-around-proteins">Chapter 4: Lipid Domains Around Proteins</a>
  <ul class="collapse">
  <li><a href="#overview-3" id="toc-overview-3" class="nav-link" data-scroll-target="#overview-3">Overview</a></li>
  <li><a href="#create-circular-domains-using-dai" id="toc-create-circular-domains-using-dai" class="nav-link" data-scroll-target="#create-circular-domains-using-dai">Create Circular Domains Using DAI</a></li>
  <li><a href="#build-the-membrane-using-pcg-3" id="toc-build-the-membrane-using-pcg-3" class="nav-link" data-scroll-target="#build-the-membrane-using-pcg-3">Build the Membrane using PCG</a></li>
  <li><a href="#visualization-3" id="toc-visualization-3" class="nav-link" data-scroll-target="#visualization-3">Visualization</a></li>
  </ul></li>
  <li><a href="#chapter-5-analytical-shapes" id="toc-chapter-5-analytical-shapes" class="nav-link" data-scroll-target="#chapter-5-analytical-shapes">Chapter 5: Analytical Shapes</a>
  <ul class="collapse">
  <li><a href="#overview-4" id="toc-overview-4" class="nav-link" data-scroll-target="#overview-4">Overview</a></li>
  <li><a href="#sinusoidal-membrane-1d-fourier" id="toc-sinusoidal-membrane-1d-fourier" class="nav-link" data-scroll-target="#sinusoidal-membrane-1d-fourier">Sinusoidal Membrane (1D Fourier)</a></li>
  <li><a href="#other-analytical-shapes" id="toc-other-analytical-shapes" class="nav-link" data-scroll-target="#other-analytical-shapes">Other Analytical Shapes</a></li>
  <li><a href="#adding-shape-preserving-walls" id="toc-adding-shape-preserving-walls" class="nav-link" data-scroll-target="#adding-shape-preserving-walls">Adding Shape-Preserving Walls</a></li>
  <li><a href="#visualization-4" id="toc-visualization-4" class="nav-link" data-scroll-target="#visualization-4">Visualization</a></li>
  </ul></li>
  <li><a href="#chapter-6-curvature-based-lipid-placement" id="toc-chapter-6-curvature-based-lipid-placement" class="nav-link" data-scroll-target="#chapter-6-curvature-based-lipid-placement">Chapter 6: Curvature-Based Lipid Placement</a>
  <ul class="collapse">
  <li><a href="#overview-5" id="toc-overview-5" class="nav-link" data-scroll-target="#overview-5">Overview</a></li>
  <li><a href="#the-lipid-placement-algorithm" id="toc-the-lipid-placement-algorithm" class="nav-link" data-scroll-target="#the-lipid-placement-algorithm">The Lipid Placement Algorithm</a></li>
  <li><a href="#create-initial-point-distribution" id="toc-create-initial-point-distribution" class="nav-link" data-scroll-target="#create-initial-point-distribution">Create Initial Point Distribution</a></li>
  <li><a href="#define-curvature-preferences" id="toc-define-curvature-preferences" class="nav-link" data-scroll-target="#define-curvature-preferences">Define Curvature Preferences</a></li>
  <li><a href="#optimize-lipid-placement-with-dop" id="toc-optimize-lipid-placement-with-dop" class="nav-link" data-scroll-target="#optimize-lipid-placement-with-dop">Optimize Lipid Placement with DOP</a></li>
  <li><a href="#build-curvature-informed-membrane" id="toc-build-curvature-informed-membrane" class="nav-link" data-scroll-target="#build-curvature-informed-membrane">Build Curvature-Informed Membrane</a></li>
  <li><a href="#visualization-and-analysis" id="toc-visualization-and-analysis" class="nav-link" data-scroll-target="#visualization-and-analysis">Visualization and Analysis</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TS2CG 2.0 as a membrane builder</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Tutorial authors</strong>: J.A. Stevens, with contributions from F. Schuhmann, C.M. Brown and M. Bozoflu <br> <strong>In case of issues</strong>: Please contact <a href="mailto:j.a.stevens@rug.nl">j.a.stevens@rug.nl</a>, <a href="mailto:fabian.schuhmann@nbi.ku.dk">fabian.schuhmann@nbi.ku.dk</a> or <a href="mailto:w.pezeshkian@nbi.ku.dk">weria.pezeshkian@nbi.ku.dk</a></p>
<hr>
<section id="table-of-contents" class="level2">
<h2 class="anchored" data-anchor-id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation-and-setup">Installation and Setup</a></li>
<li><a href="#chapter-1-basic-vesicle">Chapter 1: Basic Uniform Vesicle</a></li>
<li><a href="#chapter-2-lipid-mixtures">Chapter 2: Lipid Mixtures</a></li>
<li><a href="#chapter-3-membrane-proteins">Chapter 3: Membrane Proteins</a></li>
<li><a href="#chapter-4-lipid-domains-around-proteins">Chapter 4: Lipid Domains Around Proteins</a></li>
<li><a href="#chapter-5-analytical-shapes">Chapter 5: Analytical Shapes</a></li>
<li><a href="#chapter-6-curvature-based-lipid-placement">Chapter 6: Curvature-Based Lipid Placement</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p><em>TS2CG</em> is a tool for building coarse-grained (CG) membrane models with user-defined and experimentally informed shapes and compositions<span class="math inline">\(^1\)</span>. It builds simulation-ready membrane models for molecular dynamics (MD) simulations, based on triangulated surfaces or analytical membrane shape definitions. Additionally, <em>TS2CG</em> serves as a backmapping algorithm that converts dynamically triangulated surface (DTS) simulations into CG MD simulations<span class="math inline">\(^{2, 3}\)</span>.</p>
<p>The latest release is <em>TS2CG</em> version 2.0, representing an advancement in membrane modeling capabilities<span class="math inline">\(^1\)</span>. Building upon the original <em>TS2CG</em>, version 2.0 introduces new features for automated protein placement and curvature-informed lipid distributions. Additionally, it features a Python API that improves ease of use and enables easier extensibility through integration with Python modules.</p>
<p><img src="image_0.png" class="img-fluid"> <strong>Figure 1: TS2CG 2.0 showcase models<span class="math inline">\(^1\)</span>.</strong> a) Mitochondrial crista with curvature-sorted lipids and proteins<span class="math inline">\(^4\)</span> b) Martini 3 Möbius strip membrane c) Glycolipid membrane with CTxB peripheral membrane protein d) Mitochondrial membrane from cryo-ET data with curvature-dependent lipid placement.</p>
<p><em>TS2CG</em> enables the creation of biologically realistic membrane models by providing precise control over membrane geometry, protein placement, and lipid composition. Designed primarily for the Martini coarse-grained force field<span class="math inline">\(^5\)</span>, it is particularly well-suited for large-scale membrane simulations.</p>
<p>Through six progressive chapters, we’ll demonstrate <em>TS2CG’s</em> capabilities by building increasingly complex membrane models:</p>
<p><strong>Chapters 1-4</strong>: Start with a simple vesicle and progressively add lipid mixtures, membrane proteins, and protein-specific lipid domains.</p>
<p><strong>Chapters 5-6</strong>: Use analytical membrane shapes and curvature-informed lipid placement.</p>
<p>Each chapter builds upon previous concepts while introducing new features. By the end, you’ll be equipped to create complex, biologically relevant membrane models ready for molecular dynamics simulation.</p>
<section id="the-ts2cg-workflow" class="level3">
<h3 class="anchored" data-anchor-id="the-ts2cg-workflow">The TS2CG Workflow</h3>
<p>The typical <em>TS2CG</em> workflow consists of several key steps:</p>
<ul>
<li><strong>Input</strong>: Triangulated surfaces (.tsi, .q, .dat files) or analytical shape definitions</li>
<li><strong>Pointillism (PLM)</strong>: Generates monolayer point distributions from triangulated surfaces and stores them in a point folder</li>
<li><strong>Point folder customization</strong>:
<ul>
<li><strong>INU</strong>: Adds inclusions (proteins) and exclusions (membrane pores)</li>
<li><strong>DAI</strong>: Creates circular lipid domains around protein types</li>
<li><strong>DOP</strong>: Optimizes lipid placement based on curvature preferences</li>
</ul></li>
<li><strong>Membrane Building (PCG)</strong>: Places lipids and proteins on the customized point distribution</li>
<li><strong>Output</strong>: Simulation-ready topology and coordinate files for GROMACS</li>
</ul>
<p><img src="image_1.png" class="img-fluid"> <strong>Figure 2: TS2CG 2.0 workflow diagram.</strong> The workflow can start from an analytical shape or an arbitrary triangulated surface. Through PLM or PCG, a point directory is created which can then be manipulated using the Python API to place proteins, exclusions or introduce lipid domains. Lastly, PCG turns the point folder into a membrane model ready for MD simulation.</p>
</section>
</section>
<section id="installation-and-setup" class="level2">
<h2 class="anchored" data-anchor-id="installation-and-setup">Installation and Setup</h2>
<section id="installing-ts2cg" class="level3">
<h3 class="anchored" data-anchor-id="installing-ts2cg">Installing TS2CG</h3>
<p><em>TS2CG</em> combines high-performance C++ algorithms with a user-friendly Python API. The C++ core provides computational efficiency, while the Python interface streamlines installation and enables easy integration with existing workflows.</p>
<p>Install <em>TS2CG</em> directly via <code>pip</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip3</span> install git+https://github.com/weria-pezeshkian/TS2CG-v2.0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>TS2CG is being developed on <a href="https://github.com/weria-pezeshkian/TS2CG-v2.0">GitHub</a>. For bug reports, feature requests, or technical issues, please open an issue on the GitHub repository.</p>
</div>
</div>
</section>
<section id="download-tutorial-files" class="level3">
<h3 class="anchored" data-anchor-id="download-tutorial-files">Download Tutorial Files</h3>
<p>Before starting the tutorials, download the required structure and parameter files <a href="https://cgmartini-library.s3.ca-central-1.amazonaws.com/0_Tutorials/m3_tutorials/TS2CG/tutorial_files.tar.gz"><strong>here</strong></a>. Extract the files:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-xzf</span> tutorial_files.tar.gz</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> tutorial_files</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This archive contains:</p>
<ul>
<li><strong>structures/:</strong> Molecular structures: proteins (<code>protein.gro</code>), solvent (<code>water.gro</code>), and triangulated meshes (<code>sphere.tsi</code>)</li>
<li><strong>topology/:</strong> Martini 3 force field files and protein topologies (<code>protein.itp</code>)</li>
<li><strong><code>Martini3.LIB</code>:</strong> TS2CG lipid library defining molecular connectivity for membrane building</li>
</ul>
</section>
<section id="additional-requirements" class="level3">
<h3 class="anchored" data-anchor-id="additional-requirements">Additional Requirements</h3>
<ul>
<li>Standard command line tools</li>
<li>Visualization software: <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a></li>
<li>Simulation software: <a href="https://www.gromacs.org/">GROMACS</a></li>
</ul>
<hr>
</section>
</section>
<section id="chapter-1-basic-vesicle" class="level2">
<h2 class="anchored" data-anchor-id="chapter-1-basic-vesicle">Chapter 1: Basic Vesicle</h2>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<p>We start with the basic <em>TS2CG</em> workflow by creating a simple POPC vesicle. This demonstrates the core <strong>Mesh→PLM→PCG</strong> workflow and introduces the essential file formats and parameters.</p>
</section>
<section id="generate-point-folder-with-plm" class="level3">
<h3 class="anchored" data-anchor-id="generate-point-folder-with-plm">Generate Point Folder with PLM</h3>
<p>The workflow starts by converting the provided spherical triangulated surface (<code>sphere.tsi</code>) into a point distribution using pointillism (PLM), the process of transforming a mesh into discrete points that will guide membrane construction. The <code>.tsi</code> file format contains vertex coordinates and triangle connectivity. For detailed specifications, see the <a href="https://github.com/weria-pezeshkian/TS2CG-v2.0"><em>TS2CG</em> documentation</a>.</p>
<p>Execute the pointillism operation with the following command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the point folder</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PLM <span class="at">-TSfile</span> structures/sphere.tsi <span class="at">-bilayerThickness</span> 3 <span class="at">-rescalefactor</span> 5 5 5 <span class="at">-Mashno</span> 4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>PLM parameters:</strong></p>
<ul>
<li><code>-TSfile</code>: Input triangulated surface file</li>
<li><code>-bilayerThickness</code>: Distance between monolayers (nm)</li>
<li><code>-rescalefactor</code>: Scaling factors for x, y, z dimensions</li>
<li><code>-Mashno</code>: Pointillism iterations to increase mesh resolution (recommended: 1-4 iterations)</li>
</ul>
<p>This creates a <code>point/</code> folder with the bilayer point distributions, an <code>extended.tsi</code> with increased resolution, and a <code>pcg.log</code> file. The <code>pointvisualization_data/</code> folder contains visualization files to inspect the generated structure:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vmd</span> <span class="at">-m</span> pointvisualization_data/Upper.gro pointvisualization_data/Lower.gro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You should observe two leaflets of points that represent the bilayer where lipids will be placed. Each point has an associated coordinate frame defining the local membrane normal and tangent directions. The pointvisualization files are useful for understanding your membrane geometry before proceeding. Take time to examine how the points are distributed before continuing.</p>
</section>
<section id="create-lipid-composition-file" class="level3">
<h3 class="anchored" data-anchor-id="create-lipid-composition-file">Create Lipid Composition File</h3>
<p>Define the membrane composition by creating a file named <code>input.str</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">[Lipids</span> List]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Domain</span> 0</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">POPC</span> 1 1 0.64</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Format explanation:</strong></p>
<ul>
<li><code>Domain 0</code>: Default domain for all lipids</li>
<li><code>POPC 1 1 0.64</code>: Lipid type, upper leaflet ratio, lower leaflet ratio, area per lipid
<ul>
<li><code>Lipid type</code>: Define the lipid type</li>
<li><code>Upper lipid ratio</code>: Fraction of the upper leaflet occupied by the lipid type</li>
<li><code>Lower lipid ratio</code>: Fraction of the lower leaflet occupied by the lipid type</li>
<li><code>Area per lipid</code>: Surface area occupied by a single lipid (<span class="math inline">\(nm^{2}\)</span>)</li>
</ul></li>
</ul>
</section>
<section id="build-the-membrane-using-pcg" class="level3">
<h3 class="anchored" data-anchor-id="build-the-membrane-using-pcg">Build the Membrane using PCG</h3>
<p>Place lipids on the point distribution to create the final membrane structure:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-dts</span> point <span class="at">-str</span> input.str <span class="at">-Bondlength</span> 0.2 <span class="at">-LLIB</span> Martini3.LIB <span class="at">-defout</span> output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>PCG parameters:</strong></p>
<ul>
<li><code>-dts</code>: Folder containing point distributions from PLM</li>
<li><code>-str</code>: Membrane composition file</li>
<li><code>-Bondlength</code>: Bond length between lipid beads (nm)</li>
<li><code>-LLIB</code>: Lipid library file containing the lipid structure</li>
<li><code>-defout</code>: Base name for generated files (default: “output”)</li>
</ul>
<p>The PCG step performs the actual membrane assembly by placing lipids and generating an <code>output.gro</code> (coordinate file), <code>output.top</code> (GROMACS topology), and <code>pcg.log</code>. The number of lipids placed is determined by the specified area per lipid (APL) and distributed across the available points. The bond length parameter controls the initial spacing of lipid beads, which is intentionally set small so that lipids can expand during energy minimization to form a continuous bilayer.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When performing the PLM step you can use <code>-monolayer 1</code> or <code>-monolayer -1</code> to create only the upper or lower monolayers. The rest of the steps are identical.</p>
</div>
</div>
</section>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization">Visualization</h3>
<p>Open the system with <code>VMD</code> to inspect the generated membrane:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">vmd</span> output.gro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result should be similar to the snapshot shown below, you can observe:</p>
<ul>
<li>A complete bilayer vesicle</li>
<li>No overlapping lipid placements</li>
</ul>
<p><img src="image_2.png" class="img-fluid"> <strong>Figure 3: Basic POPC vesicle.</strong> a) Spherical vesicle containing only POPC lipids (green). b) Cross-sectional view showing both membrane leaflets.</p>
<hr>
</section>
</section>
<section id="chapter-2-lipid-mixtures" class="level2">
<h2 class="anchored" data-anchor-id="chapter-2-lipid-mixtures">Chapter 2: Lipid Mixtures</h2>
<section id="overview-1" class="level3">
<h3 class="anchored" data-anchor-id="overview-1">Overview</h3>
<p>Real biological membranes are composed of multiple lipid types with varying concentrations that can differ between membrane leaflets. This chapter builds on the basic workflow to create a mixed-composition membrane, demonstrating how to control lipid ratios through uniform random distribution.</p>
</section>
<section id="create-mixed-composition" class="level3">
<h3 class="anchored" data-anchor-id="create-mixed-composition">Create Mixed Composition</h3>
<p>Define a membrane with multiple lipid types by modifying the <code>input.str</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">[Lipids</span> List]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Domain</span> 0</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">POPC</span> 0.5 0.5 0.64</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="ex">DOPC</span> 0.5 0.5 0.67</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Adding a second lipid definition, creating a 50:50 mixture of POPC and DOPC lipids. Note that DOPC has a slightly larger APL (0.67 nm²) compared to POPC (0.64 nm²). When working with lipid mixtures, ensure that the APL values are realistic for your lipid types. The values should be based on experimental data and your chosen force field.</p>
</section>
<section id="build-the-membrane-using-pcg-1" class="level3">
<h3 class="anchored" data-anchor-id="build-the-membrane-using-pcg-1">Build the Membrane using PCG</h3>
<p>Place the mixed lipid composition on the existing point distribution:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build mixed membrane using the same point folder from Chapter 1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-str</span> input.str <span class="at">-Bondlength</span> 0.2 <span class="at">-LLIB</span> Martini3.LIB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The algorithm randomly distributes the two lipid types over the point distribution.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This will override the <code>output.gro</code> and <code>output.top</code> files created in the previous chapter.</p>
</div>
</div>
</section>
<section id="visualization-1" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1">Visualization</h3>
<p>Open the system with <code>VMD</code> to inspect the generated membrane:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the model</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">vmd</span> output.gro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result should be similar to the snapshot shown below, you can observe:</p>
<ul>
<li>A complete bilayer vesicle</li>
<li>No overlapping lipid placements</li>
<li>Randomly mixed POPC and DOPC lipids in both leaflets</li>
</ul>
<p><img src="image_3.png" class="img-fluid"> <strong>Figure 4: Mixed POPC/DOPC vesicle.</strong> a) Spherical vesicle with a 50% POPC (green) and 50% DOPC (cyan) composition. b) Cross-sectional view showing both membrane leaflets.</p>
<hr>
</section>
</section>
<section id="chapter-3-membrane-proteins" class="level2">
<h2 class="anchored" data-anchor-id="chapter-3-membrane-proteins">Chapter 3: Membrane Proteins</h2>
<section id="overview-2" class="level3">
<h3 class="anchored" data-anchor-id="overview-2">Overview</h3>
<p>Integral and peripheral membrane proteins are essential components that require careful integration during membrane model building. This chapter introduces automated protein placement using <em>TS2CG’s</em> INU tool, demonstrating how to randomly position proteins in membranes while preventing lipid-protein clashes.</p>
</section>
<section id="adding-a-protein-to-the-membrane" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-protein-to-the-membrane">Adding a Protein to the Membrane</h3>
<p>Define the membrane composition including membrane proteins by modifying <code>input.str</code> to include a protein section:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">include</span> structures/protein_1.gro</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">include</span> structures/protein_2.gro</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="ex">[Lipids</span> List]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Domain</span> 0</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="ex">POPC</span> 0.5 0.5 0.64</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="ex">DOPC</span> 0.5 0.5 0.67</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="ex">[Protein</span> List]</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span><span class="ex">proteinname</span> type     i       j     k    shift</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="ex">protein_1</span>     1     0.01     0     0     <span class="at">-2</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="ex">protein_2</span>     2     0.01     0     0     <span class="at">-2</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span> Protein</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Format explanation:</strong></p>
<ul>
<li><code>protein 1 0.01 0 0 -2</code>:
<ul>
<li><code>protein_name</code>: Must match the header of the <code>.gro</code> file</li>
<li><code>type_id</code>: Assign a unique integer to each protein type</li>
<li><code>surface_coverage</code>: Fraction of membrane area occupied by proteins (typically set to 0.01)</li>
<li>Two unused parameters: For now set to 0</li>
<li><code>z_offset</code>: Distance to move protein along the membrane normal</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To identify the transmembrane region of your proteins and orient them correctly along the z-direction, use the Positioning of Proteins in Membranes (PPM) webserver. This tool determines the optimal membrane insertion depths and orientations based on protein structure and hydrophobicity profiles.</p>
</div>
</div>
</section>
<section id="place-proteins-using-inu" class="level3">
<h3 class="anchored" data-anchor-id="place-proteins-using-inu">Place Proteins using INU</h3>
<p>Use the INU (Inclusion Utility) tool to randomly place proteins in the membrane:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the membrane proteins</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> INU <span class="at">--protein-type</span> 1 <span class="at">--radius</span> 5 <span class="at">--num-proteins</span> 5</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> INU <span class="at">--protein-type</span> 2 <span class="at">--radius</span> 10 <span class="at">--num-proteins</span> 5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>INU Parameters:</strong></p>
<ul>
<li><code>-p, --point-dir</code>: Input point directory from PLM</li>
<li><code>-t, --protein-type</code>: Protein type identifier (matches [Protein List])</li>
<li><code>-r, --radius</code>: Exclusion radius around proteins (nm)</li>
<li><code>-n, --num-proteins</code>: Number of proteins to place</li>
<li><code>-o, --output</code>: Output point directory with proteins</li>
</ul>
<p>This automatically places the two types of proteins in the membrane membrane while preventing protein-protein overlaps using the <code>--radius</code> flag.</p>
</section>
<section id="build-the-membrane-using-pcg-2" class="level3">
<h3 class="anchored" data-anchor-id="build-the-membrane-using-pcg-2">Build the Membrane using PCG</h3>
<p>Place the lipids and proteins using the modified point directory:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build complete model</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-str</span> input.str <span class="at">-Bondlength</span> 0.2 <span class="at">-LLIB</span> Martini3.LIB <span class="at">-incdirtype</span> Local <span class="at">-Rcutoff</span> .65</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>PCG parameters:</strong></p>
<ul>
<li><code>-incdirtype</code>: Use local reference frames for proteins placed by INU (required when using INU)</li>
<li><code>-Rcutoff</code>: Set the cutoff distance used to remove lipids near proteins.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>An important parameter here is the <code>-Rcutoff</code>, which sets the exclusion distance around proteins where lipids are removed. After building, always check that <em>TS2CG</em> hasn’t placed lipids in unphysical locations, such as inside protein channels. If you find lipids within protein cavities, increase the cutoff radius and rebuild your system.</p>
</div>
</div>
</section>
<section id="visualization-2" class="level3">
<h3 class="anchored" data-anchor-id="visualization-2">Visualization</h3>
<p>Open the system with <code>VMD</code> to inspect the generated membrane:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="ex">vmd</span> output.gro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result should be similar to the snapshot shown below, you can observe:</p>
<ul>
<li>A complete bilayer vesicle with embedded proteins</li>
<li>No lipid-protein or protein-protein overlaps</li>
<li>Mixed POPC and DOPC lipids in both leaflets</li>
<li>Proteins randomly distributed in the membrane</li>
</ul>
<p><img src="image_4.png" class="img-fluid"> <strong>Figure 5: Protein-containing vesicle.</strong> a) Spherical vesicle with a 50% POPC (green) and 50% DOPC (cyan) composition with randomly distributed membrane proteins (grey). b) Cross-sectional view showing both membrane leaflets.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember to verify protein orientation within the membrane. Transmembrane proteins should span the bilayer with correct topology, since proper orientation is crucial for realistic membrane models. Type I proteins have their N-terminus extracellular and C-terminus cytoplasmic, while Type II proteins have the opposite orientation.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="chapter-4-lipid-domains-around-proteins" class="level2">
<h2 class="anchored" data-anchor-id="chapter-4-lipid-domains-around-proteins">Chapter 4: Lipid Domains Around Proteins</h2>
<section id="overview-3" class="level3">
<h3 class="anchored" data-anchor-id="overview-3">Overview</h3>
<p>Proteins often influence their local lipid environment, creating specialized domains with distinct compositions that are crucial for protein function and membrane stability. This chapter demonstrates how to create protein-specific lipid microenvironments that mimic biological membrane organization using <em>TS2CG’s</em> DAI (Domains Around Inclusion) tool.</p>
</section>
<section id="create-circular-domains-using-dai" class="level3">
<h3 class="anchored" data-anchor-id="create-circular-domains-using-dai">Create Circular Domains Using DAI</h3>
<p>Use the DAI tool to create circular lipid domains around the proteins in the existing point folder from Chapter 3:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create domain 1 (radius 5 nm) around proteins of type 1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> DAI <span class="at">--point-dir</span> point <span class="at">--protein-type</span> 1 <span class="at">--radius</span> 7 <span class="at">--domain</span> 1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>DAI Parameters:</strong></p>
<ul>
<li><code>-p, --point-dir</code>: Path to point folder</li>
<li><code>-t, --protein-type</code>: Protein type ID to use as domain centers</li>
<li><code>-r, --radius</code>: Radius for circular domain assignment (nm)</li>
<li><code>-d, --domain-id</code>: Domain ID to assign</li>
<li><code>-m, --manual-points</code>: Comma-separated point IDs to use as domain centers (not used here)</li>
<li><code>-o, --output-dir</code>: Output directory (default: overwrite input with backup)</li>
</ul>
<p>All proteins of the specified type are automatically identified and a circular domain is created around them. If circular domains overlap, the later command overwrites the domain specification of the earlier one. Consider this when designing systems with multiple protein types or high protein densities.</p>
<p>Define Domain-Specific Composition Now we have to define the composition of the newly created lipid domains in the membrane by modifying <code>input.str</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">include</span> Proteins/protein_1.gro</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">include</span> Proteins/protein_2.gro</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="ex">[Lipids</span> List]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Domain</span> 0</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="ex">POPC</span> 1.0 1.0 0.64</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Domain</span> 1</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="ex">DOPC</span> 1.0 1.0 0.67</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="ex">[Protein</span> List]</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span><span class="ex">proteinname</span> type     i       j     k    shift</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="ex">protein_1</span>     1     0.01     0     0     <span class="at">-2</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="ex">protein_2</span>     2     0.01     0     0     <span class="at">-2</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span> Protein</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This configuration creates two distinct lipid environments: POPC in the bulk membrane (Domain 0) and DOPC around proteins (Domain 1).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many membrane proteins have experimentally validated preferences for specific lipid types that can guide your domain composition. Consider using this feature to improve the biological relevance of your model.</p>
</div>
</div>
</section>
<section id="build-the-membrane-using-pcg-3" class="level3">
<h3 class="anchored" data-anchor-id="build-the-membrane-using-pcg-3">Build the Membrane using PCG</h3>
<p>Build the membrane with domain-specific compositions:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build with domain-specific compositions</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-str</span> input.str <span class="at">-Bondlength</span> 0.2 <span class="at">-LLIB</span> Martini3.LIB <span class="at">-incdirtype</span> Local <span class="at">-Rcutoff</span> .65</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The PCG algorithm respects the domain assignments created by DAI and places the appropriate lipid types in each region, creating a heterogeneous membrane with protein-specific lipid environments.</p>
</section>
<section id="visualization-3" class="level3">
<h3 class="anchored" data-anchor-id="visualization-3">Visualization</h3>
<p>Open the system with <code>VMD</code> to inspect the generated membrane:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the model</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="ex">vmd</span> output.gro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result should be similar to the snapshot shown below, you can observe:</p>
<ul>
<li>A complete bilayer vesicle with embedded proteins</li>
<li>Two distinct lipid domains in both leaflets
<ul>
<li>Domain 0: POPC (bulk membrane)</li>
<li>Domain 1: DOPC around protein copies</li>
</ul></li>
<li>Proteins randomly distributed in the membrane</li>
<li>Clear lipid domain boundaries around proteins</li>
</ul>
<p><img src="image_5.png" class="img-fluid"> <strong>Figure 6: Vesicle with protein-specific lipid domains.</strong> a) Spherical vesicle with circular DOPC (cyan) domains around randomly distributed membrane proteins (grey), while the bulk membrane consisting of POPC lipids. b) Cross-sectional view showing both membrane leaflets.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Ready to simulate?</strong> Complete simulation protocols, including GROMACS <code>.mdp</code> files and instructions for running membrane simulations are in our <a href="https://github.com/weria-pezeshkian/TS2CG-v2.0/wiki/Tutorial-10">GitHub tutorials</a>.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="chapter-5-analytical-shapes" class="level2">
<h2 class="anchored" data-anchor-id="chapter-5-analytical-shapes">Chapter 5: Analytical Shapes</h2>
<section id="overview-4" class="level3">
<h3 class="anchored" data-anchor-id="overview-4">Overview</h3>
<p>While triangulated surfaces provide flexibility for building complex membrane geometries, analytical shapes offer parametric control and reproducibility that are essential for systematic studies. This chapter demonstrates <em>TS2CG’s</em> ability to generate membranes with precise geometries, eliminating the variability inherent in the mesh-based approach. We also introduce shape-preserving walls that maintain precise membrane curvature throughout MD simulations, enabling controlled studies of curvature-dependent properties.</p>
</section>
<section id="sinusoidal-membrane-1d-fourier" class="level3">
<h3 class="anchored" data-anchor-id="sinusoidal-membrane-1d-fourier">Sinusoidal Membrane (1D Fourier)</h3>
<p>Create a curved membrane using Fourier modes by defining <code>input.str</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">[Lipids</span> List]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Domain</span> 0</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="ex">CDL2</span> 0.1 0.1 0.94</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ex">POPC</span> 0.9 0.9 0.64</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ex">[Shape</span> Data]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="ex">ShapeType</span> 1D_PBC_Fourier</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="ex">Box</span> 30 10 20</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="ex">WallRange</span> 0 1 0 1</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="ex">Density</span> 3 1</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="ex">Thickness</span> 4</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="ex">Mode</span> 1.5 1 0</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="ex">Mode</span> 2.5 2 0</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="ex">End</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Build the sinusoidal membrane directly with PCG:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-str</span> input.str <span class="at">-Bondlength</span> 0.2 <span class="at">-LLIB</span> Martini3.LIB <span class="at">-function</span> analytical_shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The sinusoidal membrane provides controlled curvature variation for studying membrane curvature effects. The Fourier modes allow precise control over wavelength and amplitude of membrane undulations.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Experiment with different Mode parameters to create various curvature patterns. The first number is the amplitude, the second is the frequency, and the third is the phase offset.</p>
</div>
</div>
</section>
<section id="other-analytical-shapes" class="level3">
<h3 class="anchored" data-anchor-id="other-analytical-shapes">Other Analytical Shapes</h3>
<p>Multiple different analytical shapes are supported and can be built using the same PCG command with the <code>-function analytical_shape</code> flag.</p>
<table class="caption-top table" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td style="border: 1px solid #ddd; padding: 20px; background: #f9f9f9; width: 50%; vertical-align: top; position: relative"><button onclick="navigator.clipboard.writeText('Cylinder\n    Box 40 40 40\n    Density 2\n    Thickness 4\n    Radius 12\nEnd')" style="position: absolute; top: 10px; right: 10px; background: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">
Copy
</button>
<u><strong>Cylinder</strong></u><br>
<span style="font-family: monospace;"> &nbsp;&nbsp;&nbsp;&nbsp;Box 40 40 40<br>
&nbsp;&nbsp;&nbsp;&nbsp;Density 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thickness 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;Radius 12<br>
End </span></td>
<td style="border: 1px solid #ddd; padding: 20px; background: #f9f9f9; width: 50%; vertical-align: top; position: relative"><button onclick="navigator.clipboard.writeText('Flat\n    Box 40 40 40\n    Density 2 2\n    Thickness 4\n    WallRange 0 1 0 1\nEnd')" style="position: absolute; top: 10px; right: 10px; background: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">
Copy
</button>
<u><strong>Flat</strong></u><br>
<span style="font-family: monospace;"> &nbsp;&nbsp;&nbsp;&nbsp;Box 40 40 40<br>
&nbsp;&nbsp;&nbsp;&nbsp;Density 2 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thickness 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;WallRange 0 1 0 1<br>
End </span></td>
</tr>
<tr class="even">
<td style="border: 1px solid #ddd; padding: 20px; background: #f9f9f9; width: 50%; vertical-align: top; position: relative"><button onclick="navigator.clipboard.writeText('1D Fourier Shape\n    Box 20 10 20\n    WallRange 0 1 0 1\n    Density 3 1\n    Thickness 4\n    Mode 1.5 1 0\n    Mode 0.5 2 0\nEnd')" style="position: absolute; top: 10px; right: 10px; background: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">
Copy
</button>
<u><strong>1D Fourier Shape</strong></u><br>
<span style="font-family: monospace;"> &nbsp;&nbsp;&nbsp;&nbsp;Box 20 10 20<br>
&nbsp;&nbsp;&nbsp;&nbsp;WallRange 0 1 0 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;Density 3 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thickness 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;Mode 1.5 1 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;Mode 0.5 2 0<br>
End </span></td>
<td style="border: 1px solid #ddd; padding: 20px; background: #f9f9f9; width: 50%; vertical-align: top; position: relative"><button onclick="navigator.clipboard.writeText('Sphere\n    Box 40 40 40\n    Density 2\n    WallDensity 1 1\n    Thickness 4\n    DL 0.2\n    Radius 15\nEnd')" style="position: absolute; top: 10px; right: 10px; background: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">
Copy
</button>
<u><strong>Sphere</strong></u><br>
<span style="font-family: monospace;"> &nbsp;&nbsp;&nbsp;&nbsp;Box 40 40 40<br>
&nbsp;&nbsp;&nbsp;&nbsp;Density 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;WallDensity 1 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thickness 4<br>
&nbsp;&nbsp;&nbsp;&nbsp;DL 0.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;Radius 15<br>
End </span></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The density parameters control the number of lipids per unit area. Higher densities create more tightly packed membranes, while lower densities may result in gaps.</p>
</div>
</div>
</section>
<section id="adding-shape-preserving-walls" class="level3">
<h3 class="anchored" data-anchor-id="adding-shape-preserving-walls">Adding Shape-Preserving Walls</h3>
<p>Membranes can deform during MD simulation as the system equilibrates, potentially losing the precise geometry and curvature that may be essential for studies such as lipid sorting or curvature-dependent protein behavior. Wall beads provide a solution by constraining the membrane to maintain its desired shape throughout the simulation.</p>
<p>To maintain membrane curvature during simulation, add wall generation:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add wall generation flags</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-str</span> input.str <span class="at">-Bondlength</span> 0.2 <span class="at">-LLIB</span> Martini3.LIB <span class="at">-function</span> analytical_shape <span class="at">-Wall</span> <span class="at">-WallH</span> 0.1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters explained:</strong></p>
<ul>
<li><code>-Wall</code>: Generate wall beads (WL)</li>
<li><code>-WallH 0.1</code>: Place wall beads 0.1 nm above the lipid headgroup.</li>
</ul>
<p>When using the <code>-Wall</code>, PCG generates a <code>Wall.itp</code> file containing wall bead parameters. The wall beads interact repulsively with lipid tail beads (C1 and C4h) while being invisible to headgroups. Include <code>Wall.itp</code> in your topology file along with the Martini force field files.</p>
<p>The wall beads act as a scaffold that preserves the membrane shape while allowing normal lipid dynamics within the constrained geometry, enabling controlled studies of curvature-dependent membrane properties.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Simulating wall-constrained membranes requires careful attention to the simulation protocol. Wall parameters must be chosen to maintain membrane shape while allowing normal lipid diffusion. For detailed protocols, see <a href="https://doi.org/10.1016/bs.mie.2024.03.010">this book chapter</a>.</p>
</div>
</div>
</section>
<section id="visualization-4" class="level3">
<h3 class="anchored" data-anchor-id="visualization-4">Visualization</h3>
<p>Open the system with <code>VMD</code> to inspect the generated membrane:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the model</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">vmd</span> output.gro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result should be similar to the snapshot shown below, you can observe:</p>
<ul>
<li>A continuous 1D fourier sinusoidal membrane</li>
<li>Wall beads around the bilayer</li>
</ul>
<p><img src="image_6.png" class="img-fluid"> <strong>Figure 7: Analytical sinusoidal membrane shape.</strong> a) Analytically generated sinusoidal 1D Fourier membrane membranes with a 90% POPC (green) and 10% CDL2 (cyan) composition. b) The same membrane system now also showing the wall beads (gray spheres) positioned around the bilayer to the defined curvature during simulation. —</p>
</section>
</section>
<section id="chapter-6-curvature-based-lipid-placement" class="level2">
<h2 class="anchored" data-anchor-id="chapter-6-curvature-based-lipid-placement">Chapter 6: Curvature-Based Lipid Placement</h2>
<section id="overview-5" class="level3">
<h3 class="anchored" data-anchor-id="overview-5">Overview</h3>
<p>This chapter introduces <em>TS2CG’s</em> experimental DOP (Distribution-based Optimized Placement) tool, which enables curvature-informed lipid placement in membranes. While this approach represents a step toward building more realistic starting configurations of large membranes, it should be considered a research tool requiring careful parameter selection and validation.</p>
<p>Different lipid geometries have distinct curvature preferences in biological membranes. The critical packing parameter (CPP) is a dimensionless number used to predict the self-assembled structure of surfactant molecules in solution. It’s defined by the ratio of a surfactant’s hydrophobic tail volume and the product of its head group area and tail length. The CPP value helps determine whether a surfactant will form micelles, bilayers, or other aggregate structures. Cone-shaped lipids tend to favor negative curvature regions, while inverted cone-shaped lipids prefer positive curvature. The DOP tool leverages this principle to create non-random lipid distributions that may reduce equilibration times and provide more realistic starting configurations.</p>
</section>
<section id="the-lipid-placement-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="the-lipid-placement-algorithm">The Lipid Placement Algorithm</h3>
<p>The curvature-dependent lipid placement probability is calculated using a Boltzmann-weighted function:</p>
<p><span class="math display">\[
\begin{aligned}
P(l) ∝ e^{-k(2H-C_0)2}
\end{aligned}
\]</span></p>
<p>Where:</p>
<ul>
<li><strong><span class="math inline">\(P(l)\)</span></strong>: Placement probability for lipid type <em>l</em></li>
<li><strong><span class="math inline">\(H\)</span></strong>: Local mean curvature at the membrane point</li>
<li><strong><span class="math inline">\(C_0\)</span></strong>: Intrinsic curvature preference of the lipid type</li>
<li><strong><span class="math inline">\(k\)</span></strong>: User-defined scaling factor controlling domain sharpness</li>
</ul>
<p>This probability function guides the stochastic lipid assignment at each membrane point. The algorithm iterates over each point in random order to prevent systematic bias, calculating placement probabilities for all lipid types and normalizing them to preserve the specified overall lipid composition.</p>
</section>
<section id="create-initial-point-distribution" class="level3">
<h3 class="anchored" data-anchor-id="create-initial-point-distribution">Create Initial Point Distribution</h3>
<p>Using the sinusoidal membrane configuration from Chapter 5, first generate the point folder:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate point folder (required for DOP)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-str</span> input.str <span class="at">-function</span> analytical_shape <span class="at">-WPointDir</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>-WPointDir</code> flag tells PCG to only generate the point folder containing <code>InnerBM.dat</code> and <code>OuterBM.dat</code> files with geometric information needed for curvature calculations, including local coordinate frames and curvature tensors at each point.</p>
</section>
<section id="define-curvature-preferences" class="level3">
<h3 class="anchored" data-anchor-id="define-curvature-preferences">Define Curvature Preferences</h3>
<p>Create <code>domain_input.txt</code> to specify lipid types and their curvature preferences:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">;</span> <span class="ex">lipid_domain</span> lipid_type percentage c0 APL</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="ex">0</span> CDL2 0.3 <span class="at">-0.1</span> 0.94</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span> POPC 0.7  0.0 0.64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Format explanation:</strong></p>
<ul>
<li><code>0 CDL2 0.3 -0.1 0.94</code>:
<ul>
<li><code>Lipid domain</code>: Assign a unique lipid domain to each lipid type</li>
<li><code>Lipid type</code>: Define the used lipid type</li>
<li><code>Lipid ratio</code>: Fraction of membrane occupied by the lipid type</li>
<li><code>Preferred curvature:</code> Assign a curvature bias for each lipid type (<span class="math inline">\(nm^{-1}\)</span>)</li>
<li><code>Area per lipid</code>: Surface area of a single lipid (<span class="math inline">\(nm^{2}\)</span>)</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Curvature preferences (C₀) are not well-defined physical constants and depend heavily on membrane composition, temperature, and local environment. The values used here should be considered adjustable parameters rather than fundamental lipid properties. Users should experiment with different C₀ values and validate results against experimental data when available.</p>
</div>
</div>
</section>
<section id="optimize-lipid-placement-with-dop" class="level3">
<h3 class="anchored" data-anchor-id="optimize-lipid-placement-with-dop">Optimize Lipid Placement with DOP</h3>
<p>Now use DOP to apply the curvature-informed assignment of lipids on the point distribution:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run curvature optimization</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> DOP <span class="at">-p</span> point <span class="at">-i</span> domain_input.txt <span class="at">-ni</span> optimized_input.str <span class="at">-k</span> 250</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>DOP Parameters:</strong></p>
<ul>
<li><code>-p, --point-dir</code>: Path to point folder</li>
<li><code>-s, --lipid-specs</code>: Domain input file with curvature preferences</li>
<li><code>-ni,--new-input</code>: Output structure file name</li>
<li><code>-k, --k-factor</code>: Curvature sensitivity (higher = more selective)</li>
<li><code>-o, --output-dir</code>: Output directory (default: overwrite input with backup)</li>
</ul>
<p>This generates a modified point folder with curvature-optimized lipid assignments and an updated <code>optimized_input.str</code> file.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The k parameter controls the strength of curvature biasing. Low values create weak preferences, while high values may produce unrealistic segregation. Start with moderate values and adjust based on your system. Remember that the parameters depend on both the lipid composition and curvature distribution of the membrane.</p>
</div>
</div>
</section>
<section id="build-curvature-informed-membrane" class="level3">
<h3 class="anchored" data-anchor-id="build-curvature-informed-membrane">Build Curvature-Informed Membrane</h3>
<p>Build the final membrane using the optimized point assignments:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build final membrane using optimized points</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="ex">TS2CG</span> PCG <span class="at">-dts</span> point <span class="at">-str</span> optimized_input.str <span class="at">-Bondlength</span> 0.2 <span class="at">-LLIB</span> Martini3.LIB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="visualization-and-analysis" class="level3">
<h3 class="anchored" data-anchor-id="visualization-and-analysis">Visualization and Analysis</h3>
<p>Open the system with <code>VMD</code> to inspect the generated membrane:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the model</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">vmd</span> output.gro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result should be similar to the snapshot shown below, you can observe:</p>
<ul>
<li>A continuous 1D fourier sinusoidal membrane</li>
<li>CDL2 (cardiolipin) concentrated in negatively curved regions</li>
<li>POPC distributed more uniformly with slight preference for less curved areas</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>While the DOP tool provides a new method to create curvature-informed lipid distributions, more research is needed to validate the biological accuracy of the constructed models, though it is still a useful tool for controlling lateral lipid organization.</p>
</div>
</div>
<p><img src="image_7.png" class="img-fluid"> <strong>Figure 8: Curvature-based lipid sorting.</strong> Analytically generated sinusoidal 1D Fourier membrane membranes showing curvature-dependent lipid placement. Cardiolipin (CDL2, cyan) preferentially located near negatively curved regions, while POPC (green) shows more uniform distribution.</p>
<hr>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>Schuhmann, F., Stevens, J., A., TS2CG as a membrane builder. BioRxiv (2025). <a href="https://www.biorxiv.org/content/10.1101/2025.04.16.649160v1">https://www.biorxiv.org/content/10.1101/2025.04.16.649160v1</a></li>
<li>Pezeshkian, W. et al.&nbsp;Backmapping triangulated surfaces to coarse-grained membrane models. Nat Commun 11, 2296 (2020). <a href="https://doi.org/10.1038/s41467-020-16094-y">https://doi.org/10.1038/s41467-020-16094-y</a></li>
<li>Pezeshkian, W. et al.&nbsp;Mesoscale simulation of biomembranes with FreeDTS. Nat Commun 15, 548 (2024). <a href="https://doi.org/10.1038/s41467-024-44819-w">https://doi.org/10.1038/s41467-024-44819-w</a></li>
<li>Brown, C.M. <em>et al.</em> An integrative modelling approach to the mitochondrial cristae. <em>Commun Biol</em> 8, 972 (2025). <a href="https://doi.org/10.1038/s42003-025-08381-">https://doi.org/10.1038/s42003-025-08381-</a></li>
<li>Souza, P.C.T. et al.&nbsp;Martini 3: a general purpose force field for coarse-grained molecular dynamics. Nat Methods 18, 382-388 (2021). <a href="https://doi.org/10.1038/s41592-021-01098-3">https://doi.org/10.1038/s41592-021-01098-3</a></li>
</ol>
<p><em>This tutorial was partially based on the original TS2CG tutorial by M. König and W. Pezeshkian.</em></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This tutorial builds upon the original TS2CG tutorial by M. König and W. Pezeshkian, updating it for TS2CG 2.0.</p>
</div>
</div>
<hr>
<p>For additional support, examples, and updates, visit the <a href="https://github.com/weria-pezeshkian/TS2CG-v2.0">TS2CG GitHub repository</a> or check the <a href="https://weria-pezeshkian.github.io/TS2CG_python_documentation/">TS2CG documentation</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/cgmartini\.nl");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<div class="footer-left">

</div>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/cg_martini">
      <i class="bi bi-twitter" role="img" aria-label="Martini Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../docs/faq/index.html">
<p><iconify-icon inline="true" role="img" icon="hugeicons:help-circle" style="font-size: 1.25em;" aria-label="FAQs" title="FAQs"></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Martini-Force-Field-Initiative">
      <i class="bi bi-github" role="img" aria-label="Martini GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
<div class="footer-right">
© 2025 Martini Force Field Initiative <img src="https://cgmartini-library.s3.ca-central-1.amazonaws.com/icon.png" alt="Icon">
</div>
</div>
  </div>
</footer>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const quotes = [
          "<i>Shaken, not stirred.</i> - James Bond",
          "<i>He was white and shaken, like a dry martini.</i> - P. G. Wodehouse",      
          "<i>I think people think we're all sipping martinis by the pool.</i> - Maria Menounos",
          "<i>Why don't you get out of that wet coat and into a dry martini?</i> - Robert Benchley",
          "<i>Really, can anyone drink several martinis at lunch?</i> - Christine Baranski",
          "<i>Zen martini: A martini with no vermouth at all. And no gin, either.</i> - P.J. O'Rourke",
          "<i>I never go jogging, it makes me spill my martini.</i> - George Burns",
          "<i>Martinis are the only American invention as perfect as a sonnet.</i> - H. L. Mencken",
          "<i>He knows just how I like my martini: full of alcohol.</i> - Homer Simpson",
          "<i>Happiness is: finding olives in your martini when you're hungry.</i> - Johnny Carson",
          "<i>If it wasn't for the olives in his martinis he'd starve to death.</i> - Milton Berle",
        ];
      const randomIndex = Math.floor(Math.random() * quotes.length);
      const randomQuote = quotes[randomIndex];

      const footerLeft = document.querySelector('.footer-left');
      if (footerLeft) {
          footerLeft.innerHTML = randomQuote;
      }
    });
</script>
<script src="../../../../js/sidebar-close.js"></script> 




</body></html>